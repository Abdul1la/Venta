[{"filePath":"C:\\Users\\NIPEAL\\Desktop\\ClothingStore\\my-react-app\\eslint.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\NIPEAL\\Desktop\\ClothingStore\\my-react-app\\public\\firebase-messaging-sw.js","messages":[{"ruleId":"no-undef","severity":2,"message":"'importScripts' is not defined.","line":2,"column":1,"nodeType":"Identifier","messageId":"undef","endLine":2,"endColumn":14},{"ruleId":"no-undef","severity":2,"message":"'importScripts' is not defined.","line":3,"column":1,"nodeType":"Identifier","messageId":"undef","endLine":3,"endColumn":14},{"ruleId":"no-undef","severity":2,"message":"'firebase' is not defined.","line":6,"column":1,"nodeType":"Identifier","messageId":"undef","endLine":6,"endColumn":9},{"ruleId":"no-undef","severity":2,"message":"'firebase' is not defined.","line":16,"column":19,"nodeType":"Identifier","messageId":"undef","endLine":16,"endColumn":27}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Import Firebase scripts for service worker\r\nimportScripts('https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js');\r\nimportScripts('https://www.gstatic.com/firebasejs/9.0.0/firebase-messaging-compat.js');\r\n\r\n// Initialize Firebase in the service worker\r\nfirebase.initializeApp({\r\n  apiKey: \"AIzaSyCROmI5S9CITU05Bi_07Fqcv3uDPfKZcUE\",\r\n  authDomain: \"venta-e740c.firebaseapp.com\",\r\n  projectId: \"venta-e740c\",\r\n  storageBucket: \"venta-e740c.firebasestorage.app\",\r\n  messagingSenderId: \"703159297432\",\r\n  appId: \"1:703159297432:web:d60a439e6807118d2937ed\",\r\n  measurementId: \"G-356E24WLC7\"\r\n});\r\n\r\nconst messaging = firebase.messaging();\r\n\r\n// Handle background messages (when app is closed or in background)\r\nmessaging.onBackgroundMessage((payload) => {\r\n  console.log('[firebase-messaging-sw.js] Background message received:', payload);\r\n  \r\n  const notificationTitle = payload.notification?.title || 'New Notification';\r\n  const notificationOptions = {\r\n    body: payload.notification?.body || 'You have a new notification',\r\n    icon: '/logo192.png', // You can customize this icon path\r\n    badge: '/logo192.png',\r\n    tag: 'notification',\r\n    requireInteraction: true\r\n  };\r\n\r\n  self.registration.showNotification(notificationTitle, notificationOptions);\r\n});\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\NIPEAL\\Desktop\\ClothingStore\\my-react-app\\src\\App.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\NIPEAL\\Desktop\\ClothingStore\\my-react-app\\src\\components\\admin\\NotificationCenter.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[128,135],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n  17 |     // Poll every 30s\n  18 |     useEffect(() => {\n> 19 |         loadNotifications();\n     |         ^^^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  20 |         const interval = setInterval(loadNotifications, 30000);\n  21 |         return () => clearInterval(interval);\n  22 |     }, []);","line":19,"column":9,"nodeType":null,"endLine":19,"endColumn":26}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { Bell, Check, X, FileText, AlertTriangle } from 'lucide-react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { notificationService } from '../../features/common/services/notificationService';\r\n\r\nconst NotificationCenter = () => {\r\n    const [isOpen, setIsOpen] = useState(false);\r\n    const [notifications, setNotifications] = useState([]);\r\n    const [unreadCount, setUnreadCount] = useState(0);\r\n\r\n    const loadNotifications = async () => {\r\n        const data = await notificationService.getNotifications(20);\r\n        setNotifications(data);\r\n        setUnreadCount(data.filter(n => !n.read).length);\r\n    };\r\n\r\n    // Poll every 30s\r\n    useEffect(() => {\r\n        loadNotifications();\r\n        const interval = setInterval(loadNotifications, 30000);\r\n        return () => clearInterval(interval);\r\n    }, []);\r\n\r\n    const handleMarkRead = async (id) => {\r\n        await notificationService.markAsRead(id);\r\n        setNotifications(prev => prev.map(n => n.id === id ? { ...n, read: true } : n));\r\n        setUnreadCount(prev => Math.max(0, prev - 1));\r\n    };\r\n\r\n    const getIcon = (type) => {\r\n        switch(type) {\r\n            case 'SHIFT_REPORT': return <FileText size={16} color=\"#007AFF\" />;\r\n            case 'LOW_STOCK': return <AlertTriangle size={16} color=\"#FF9500\" />;\r\n            default: return <Bell size={16} color=\"#555\" />;\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div style={{ position: 'relative' }}>\r\n            <button \r\n                onClick={() => setIsOpen(!isOpen)}\r\n                style={{ position: 'relative', background: 'transparent', border: 'none', padding: '8px', cursor: 'pointer' }}\r\n            >\r\n                <Bell size={24} color=\"#555\" />\r\n                {unreadCount > 0 && (\r\n                    <span style={{ \r\n                        position: 'absolute', top: 0, right: 0, \r\n                        background: '#FF453A', color: '#FFF', \r\n                        fontSize: '10px', height: '16px', minWidth: '16px', \r\n                        borderRadius: '8px', display: 'flex', alignItems: 'center', justifyContent: 'center',\r\n                        fontWeight: 'bold', padding: '0 4px', border: '2px solid #FFF'\r\n                    }}>\r\n                        {unreadCount}\r\n                    </span>\r\n                )}\r\n            </button>\r\n\r\n            <AnimatePresence>\r\n                {isOpen && (\r\n                    <>\r\n                        <div \r\n                            style={{ position: 'fixed', inset: 0, zIndex: 90 }} \r\n                            onClick={() => setIsOpen(false)} \r\n                        />\r\n                        <motion.div\r\n                            initial={{ opacity: 0, y: 10, scale: 0.95 }}\r\n                            animate={{ opacity: 1, y: 0, scale: 1 }}\r\n                            exit={{ opacity: 0, y: 10, scale: 0.95 }}\r\n                            style={{\r\n                                position: 'absolute', top: '100%', right: -10, width: '360px',\r\n                                background: '#FFF', borderRadius: '16px',\r\n                                boxShadow: '0 10px 40px rgba(0,0,0,0.15)',\r\n                                border: '1px solid #E5E5EA',\r\n                                zIndex: 100, overflow: 'hidden', display: 'flex', flexDirection: 'column',\r\n                                maxHeight: '80vh'\r\n                            }}\r\n                        >\r\n                            <div style={{ padding: '16px', borderBottom: '1px solid #F0F0F0', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n                                <h3 style={{ margin: 0, fontSize: '15px', fontWeight: 700 }}>Notifications</h3>\r\n                                <button className=\"btn\" onClick={loadNotifications} style={{ fontSize: '11px', padding: '4px 8px' }}>Refresh</button>\r\n                            </div>\r\n\r\n                            <div style={{ overflowY: 'auto' }}>\r\n                                {notifications.length === 0 ? (\r\n                                    <div style={{ padding: '32px', textAlign: 'center', color: '#999', fontSize: '13px' }}>\r\n                                        No notifications yet\r\n                                    </div>\r\n                                ) : (\r\n                                    notifications.map(n => (\r\n                                        <div \r\n                                            key={n.id}\r\n                                            style={{ \r\n                                                padding: '16px', borderBottom: '1px solid #F9F9F9',\r\n                                                background: n.read ? '#FFF' : '#F5F9FF',\r\n                                                transition: 'background 0.2s', position: 'relative'\r\n                                            }}\r\n                                        >\r\n                                            {!n.read && <div style={{ position: 'absolute', left: '0', top: '0', bottom: '0', width: '3px', background: '#007AFF' }} />}\r\n                                            <div style={{ display: 'flex', gap: '12px' }}>\r\n                                                <div style={{ \r\n                                                    background: n.read ? '#F0F0F5' : '#E5F1FF', \r\n                                                    minWidth: '32px', height: '32px', borderRadius: '8px', \r\n                                                    display: 'flex', alignItems: 'center', justifyContent: 'center' \r\n                                                }}>\r\n                                                    {getIcon(n.type)}\r\n                                                </div>\r\n                                                <div style={{ flex: 1 }}>\r\n                                                    <div style={{ display: 'flex', justifyContent: 'space-between' }}>\r\n                                                        <span style={{ fontWeight: 600, fontSize: '14px', color: n.read ? '#333' : '#000' }}>{n.title}</span>\r\n                                                        <span style={{ fontSize: '10px', color: '#999' }}>\r\n                                                            {n.createdAt?.toDate ? n.createdAt.toDate().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}) : 'Just now'}\r\n                                                        </span>\r\n                                                    </div>\r\n                                                    <p style={{ margin: '4px 0 8px', fontSize: '13px', color: '#666', lineHeight: 1.4 }}>{n.message}</p>\r\n                                                    \r\n                                                    {/* Data Payload Display */}\r\n                                                    {n.data && n.type === 'SHIFT_REPORT' && (\r\n                                                        <div style={{ background: 'rgba(0,0,0,0.03)', padding: '8px', borderRadius: '6px', fontSize: '11px', display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '4px' }}>\r\n                                                            {Object.entries(n.data).map(([key, val]) => (\r\n                                                                <div key={key}><span style={{fontWeight:600}}>{key}:</span> {val}</div>\r\n                                                            ))}\r\n                                                        </div>\r\n                                                    )}\r\n\r\n                                                    {!n.read && (\r\n                                                        <button \r\n                                                            onClick={(e) => { e.stopPropagation(); handleMarkRead(n.id); }}\r\n                                                            style={{ \r\n                                                                background: 'transparent', border: 'none', color: '#007AFF', \r\n                                                                fontSize: '11px', fontWeight: 600, padding: 0, marginTop: '8px', cursor: 'pointer' \r\n                                                            }}\r\n                                                        >\r\n                                                            Mark as read\r\n                                                        </button>\r\n                                                    )}\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    ))\r\n                                )}\r\n                            </div>\r\n                        </motion.div>\r\n                    </>\r\n                )}\r\n            </AnimatePresence>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default NotificationCenter;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\NIPEAL\\Desktop\\ClothingStore\\my-react-app\\src\\components\\ui\\ConfirmDialog.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":1,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[9,16],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { motion, AnimatePresence } from 'framer-motion';\r\nimport { AlertTriangle, X } from 'lucide-react';\r\n\r\nconst ConfirmDialog = ({ isOpen, title, message, onConfirm, onCancel, confirmText = \"Confirm\", cancelText = \"Cancel\", isDestructive = false }) => {\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <AnimatePresence>\r\n      <div style={{\r\n        position: 'fixed', top: 0, left: 0, right: 0, bottom: 0,\r\n        background: 'rgba(0,0,0,0.5)', zIndex: 9999,\r\n        display: 'flex', alignItems: 'center', justifyContent: 'center',\r\n        backdropFilter: 'blur(4px)'\r\n      }}>\r\n        <motion.div\r\n          initial={{ opacity: 0, scale: 0.95 }}\r\n          animate={{ opacity: 1, scale: 1 }}\r\n          exit={{ opacity: 0, scale: 0.95 }}\r\n          style={{\r\n            background: '#FFF', borderRadius: '24px', padding: '32px',\r\n            width: '100%', maxWidth: '400px',\r\n            boxShadow: '0 20px 50px rgba(0,0,0,0.2)',\r\n            display: 'flex', flexDirection: 'column', alignItems: 'center', textAlign: 'center'\r\n          }}\r\n        >\r\n          <div style={{ \r\n            width: '64px', height: '64px', borderRadius: '50%', \r\n            background: isDestructive ? '#FFEDEC' : '#F5F5F7', \r\n            color: isDestructive ? '#FF453A' : '#007AFF',\r\n            display: 'flex', alignItems: 'center', justifyContent: 'center', marginBottom: '24px'\r\n          }}>\r\n            <AlertTriangle size={32} />\r\n          </div>\r\n\r\n          <h3 style={{ margin: '0 0 12px', fontSize: '20px', fontWeight: 700 }}>{title}</h3>\r\n          <p style={{ margin: '0 0 32px', color: '#666', lineHeight: '1.5' }}>{message}</p>\r\n\r\n          <div style={{ display: 'flex', gap: '12px', width: '100%' }}>\r\n            <button \r\n              onClick={onCancel}\r\n              className=\"btn\"\r\n              style={{ flex: 1, padding: '16px', background: '#F5F5F7', color: '#000', border: 'none' }}\r\n            >\r\n              {cancelText}\r\n            </button>\r\n            <button \r\n              onClick={onConfirm}\r\n              className=\"btn\"\r\n              style={{ \r\n                flex: 1, padding: '16px', border: 'none', \r\n                background: isDestructive ? '#FF453A' : '#007AFF',\r\n                color: '#FFF'\r\n              }}\r\n            >\r\n              {confirmText}\r\n            </button>\r\n          </div>\r\n        </motion.div>\r\n      </div>\r\n    </AnimatePresence>\r\n  );\r\n};\r\n\r\nexport default ConfirmDialog;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\NIPEAL\\Desktop\\ClothingStore\\my-react-app\\src\\components\\ui\\NotificationBell.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[184,191],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'setupForegroundListener'. Either include it or remove the dependency array.","line":17,"column":6,"nodeType":"ArrayExpression","endLine":17,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [setupForegroundListener]","fix":{"range":[625,627],"text":"[setupForegroundListener]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { Bell } from 'lucide-react';\r\nimport { notificationService } from '../../features/common/services/notificationService';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\nconst NotificationBell = () => {\r\n  const [notifications, setNotifications] = useState([]);\r\n  const [unreadCount, setUnreadCount] = useState(0);\r\n  const [showDropdown, setShowDropdown] = useState(false);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    loadNotifications();\r\n    \r\n    // Setup foreground message listener\r\n    setupForegroundListener();\r\n  }, []);\r\n\r\n  const loadNotifications = async () => {\r\n    try {\r\n      const data = await notificationService.getNotifications(10);\r\n      setNotifications(data);\r\n      const unread = data.filter(n => !n.read).length;\r\n      setUnreadCount(unread);\r\n    } catch (error) {\r\n      console.error('[NotificationBell] Error loading notifications:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const setupForegroundListener = async () => {\r\n    try {\r\n      const { fcmService } = await import('../../lib/fcmService');\r\n      fcmService.onForegroundMessage((payload) => {\r\n        console.log('[NotificationBell] Foreground notification received:', payload);\r\n        // Reload notifications when a new one arrives\r\n        loadNotifications();\r\n        \r\n        // Show browser notification even when app is open\r\n        if (Notification.permission === 'granted') {\r\n          new Notification(payload.notification?.title || 'New Notification', {\r\n            body: payload.notification?.body || 'You have a new notification',\r\n            icon: '/logo192.png'\r\n          });\r\n        }\r\n      });\r\n    } catch (error) {\r\n      console.error('[NotificationBell] Error setting up foreground listener:', error);\r\n    }\r\n  };\r\n\r\n  const handleMarkAsRead = async (notificationId) => {\r\n    try {\r\n      await notificationService.markAsRead(notificationId);\r\n      loadNotifications();\r\n    } catch (error) {\r\n      console.error('[NotificationBell] Error marking as read:', error);\r\n    }\r\n  };\r\n\r\n  const formatTime = (timestamp) => {\r\n    if (!timestamp) return 'Just now';\r\n    const date = timestamp.toDate ? timestamp.toDate() : new Date(timestamp);\r\n    const now = new Date();\r\n    const diff = now - date;\r\n    \r\n    if (diff < 60000) return 'Just now';\r\n    if (diff < 3600000) return `${Math.floor(diff / 60000)}m ago`;\r\n    if (diff < 86400000) return `${Math.floor(diff / 3600000)}h ago`;\r\n    return date.toLocaleDateString();\r\n  };\r\n\r\n  return (\r\n    <div style={{ position: 'relative' }}>\r\n      <button\r\n        onClick={() => setShowDropdown(!showDropdown)}\r\n        style={{\r\n          position: 'relative',\r\n          background: '#FFF',\r\n          border: '1px solid #E5E5EA',\r\n          borderRadius: '12px',\r\n          width: '40px',\r\n          height: '40px',\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          justifyContent: 'center',\r\n          cursor: 'pointer',\r\n          boxShadow: '0 2px 5px rgba(0,0,0,0.03)'\r\n        }}\r\n      >\r\n        <Bell size={18} color=\"#666\" />\r\n        {unreadCount > 0 && (\r\n          <div\r\n            style={{\r\n              position: 'absolute',\r\n              top: '-4px',\r\n              right: '-4px',\r\n              background: '#FF453A',\r\n              color: '#FFF',\r\n              borderRadius: '50%',\r\n              width: '18px',\r\n              height: '18px',\r\n              fontSize: '10px',\r\n              fontWeight: 'bold',\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              justifyContent: 'center'\r\n            }}\r\n          >\r\n            {unreadCount > 9 ? '9+' : unreadCount}\r\n          </div>\r\n        )}\r\n      </button>\r\n\r\n      <AnimatePresence>\r\n        {showDropdown && (\r\n          <motion.div\r\n            initial={{ opacity: 0, y: -10 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            exit={{ opacity: 0, y: -10 }}\r\n            style={{\r\n              position: 'absolute',\r\n              top: '50px',\r\n              right: 0,\r\n              width: '350px',\r\n              maxHeight: '400px',\r\n              background: '#FFF',\r\n              borderRadius: '16px',\r\n              boxShadow: '0 8px 24px rgba(0,0,0,0.15)',\r\n              border: '1px solid #E5E5EA',\r\n              overflow: 'hidden',\r\n              zIndex: 1000\r\n            }}\r\n          >\r\n            <div style={{ padding: '16px', borderBottom: '1px solid #E5E5EA' }}>\r\n              <h3 style={{ margin: 0, fontSize: '16px', fontWeight: 700 }}>Notifications</h3>\r\n            </div>\r\n\r\n            <div style={{ maxHeight: '320px', overflowY: 'auto' }}>\r\n              {loading ? (\r\n                <div style={{ padding: '32px', textAlign: 'center', color: '#999' }}>\r\n                  Loading...\r\n                </div>\r\n              ) : notifications.length === 0 ? (\r\n                <div style={{ padding: '32px', textAlign: 'center', color: '#999' }}>\r\n                  No notifications yet\r\n                </div>\r\n              ) : (\r\n                notifications.map((notif) => (\r\n                  <div\r\n                    key={notif.id}\r\n                    onClick={() => handleMarkAsRead(notif.id)}\r\n                    style={{\r\n                      padding: '16px',\r\n                      borderBottom: '1px solid #F5F5F7',\r\n                      cursor: 'pointer',\r\n                      background: notif.read ? '#FFF' : '#F9F9FB',\r\n                      transition: 'background 0.2s'\r\n                    }}\r\n                    onMouseEnter={(e) => (e.currentTarget.style.background = '#F5F5F7')}\r\n                    onMouseLeave={(e) => (e.currentTarget.style.background = notif.read ? '#FFF' : '#F9F9FB')}\r\n                  >\r\n                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'start', marginBottom: '4px' }}>\r\n                      <div style={{ fontWeight: 600, fontSize: '14px', color: '#000' }}>\r\n                        {notif.title}\r\n                      </div>\r\n                      <div style={{ fontSize: '11px', color: '#999', whiteSpace: 'nowrap', marginLeft: '8px' }}>\r\n                        {formatTime(notif.createdAt)}\r\n                      </div>\r\n                    </div>\r\n                    <div style={{ fontSize: '13px', color: '#666' }}>\r\n                      {notif.message}\r\n                    </div>\r\n                    {!notif.read && (\r\n                      <div style={{ width: '6px', height: '6px', borderRadius: '50%', background: '#007AFF', marginTop: '8px' }} />\r\n                    )}\r\n                  </div>\r\n                ))\r\n              )}\r\n            </div>\r\n          </motion.div>\r\n        )}\r\n      </AnimatePresence>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NotificationBell;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\NIPEAL\\Desktop\\ClothingStore\\my-react-app\\src\\components\\ui\\NotificationContext.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":2,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":33,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[86,94],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":57,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":57,"endColumn":29}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createContext, useContext, useState } from 'react';\r\nimport { AnimatePresence, motion } from 'framer-motion';\r\nimport { Delete, Check, Info } from 'lucide-react';\r\n\r\nconst NotificationContext = createContext();\r\n\r\nexport const NotificationProvider = ({ children }) => {\r\n  const [notification, setNotification] = useState(null); // { message, type: 'success' | 'error' | 'info' }\r\n\r\n  const showNotification = (message, type = 'success') => {\r\n    setNotification({ message, type });\r\n    // Auto hide after 3 seconds\r\n    setTimeout(() => {\r\n        setNotification(prev => (prev && prev.message === message ? null : prev));\r\n    }, 3000);\r\n  };\r\n\r\n  return (\r\n    <NotificationContext.Provider value={{ showNotification }}>\r\n      {children}\r\n      <AnimatePresence>\r\n        {notification && (\r\n            <motion.div\r\n              initial={{ opacity: 0, y: -50, x: '-50%' }}\r\n              animate={{ opacity: 1, y: 24, x: '-50%' }}\r\n              exit={{ opacity: 0, y: -50, x: '-50%' }}\r\n              style={{\r\n                position: 'fixed', \r\n                top: 0, \r\n                left: '50%', \r\n                background: notification.type === 'error' ? '#FF453A' : notification.type === 'info' ? '#007AFF' : '#32D74B',\r\n                color: '#FFF',\r\n                padding: '12px 24px', \r\n                borderRadius: '50px',\r\n                fontWeight: '600', \r\n                fontSize: '15px',\r\n                boxShadow: '0 10px 30px rgba(0,0,0,0.2)',\r\n                zIndex: 9999, \r\n                display: 'flex', \r\n                alignItems: 'center', \r\n                gap: '10px',\r\n                minWidth: '300px',\r\n                justifyContent: 'center'\r\n              }}\r\n            >\r\n              {notification.type === 'error' && <Delete size={18} />}\r\n              {notification.type === 'success' && <Check size={18} />}\r\n              {notification.type === 'info' && <Info size={18} />}\r\n              {notification.message}\r\n            </motion.div>\r\n        )}\r\n      </AnimatePresence>\r\n    </NotificationContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useNotification = () => {\r\n    const context = useContext(NotificationContext);\r\n    if (!context) throw new Error(\"useNotification must be used within NotificationProvider\");\r\n    return context;\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\NIPEAL\\Desktop\\ClothingStore\\my-react-app\\src\\features\\auth\\AuthContext.jsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":75,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":75,"endColumn":21}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createContext, useContext, useState, useEffect } from 'react';\r\nimport { ROLES } from './services/authService';\r\n\r\nconst AuthContext = createContext();\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n  const [user, setUser] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    // Check local storage on mount\r\n    const stored = localStorage.getItem('venta_user');\r\n    if (stored) {\r\n      try {\r\n        const userData = JSON.parse(stored);\r\n        setUser(userData);\r\n        \r\n        // Don't request notification permission on page refresh\r\n        // Only request on fresh login via login() function\r\n      } catch (e) {\r\n        console.error(\"Failed to parse user session\", e);\r\n        localStorage.removeItem('venta_user');\r\n      }\r\n    }\r\n    setLoading(false);\r\n  }, []);\r\n\r\n  const login = async (userData) => {\r\n    setUser(userData);\r\n    localStorage.setItem('venta_user', JSON.stringify(userData));\r\n    \r\n    // Request notification permission for admin users\r\n    if (userData.role === ROLES.ADMIN) {\r\n      try {\r\n        console.log('[Auth] Admin user detected, setting up FCM...');\r\n        console.log('[Auth] User ID:', userData.id);\r\n        \r\n        const { fcmService } = await import('../../lib/fcmService');\r\n        const token = await fcmService.requestPermissionAndGetToken();\r\n        \r\n        console.log('[Auth] FCM Token received:', token ? 'YES' : 'NO');\r\n        \r\n        if (token && userData.id) {\r\n          console.log('[Auth] Saving token to Firestore for user ID:', userData.id);\r\n          await fcmService.saveTokenToUser(userData.id, token);\r\n          console.log('[Auth] FCM token saved successfully!');\r\n        } else {\r\n          console.warn('[Auth] Missing token or user ID:', { token: !!token, userId: userData.id });\r\n        }\r\n      } catch (error) {\r\n        console.error('[Auth] Failed to register FCM token:', error);\r\n      }\r\n    }\r\n  };\r\n\r\n  const logout = () => {\r\n    setUser(null);\r\n    localStorage.removeItem('venta_user');\r\n    localStorage.removeItem('fcm_token_registered');\r\n  };\r\n\r\n  const hasPermission = (perm) => {\r\n    if (!user) return false;\r\n    if (user.role === ROLES.ADMIN) return true; // Admins have all access\r\n    return user.permissions && user.permissions.includes(perm);\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider value={{ user, login, logout, hasPermission, loading }}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useAuth = () => useContext(AuthContext);\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\NIPEAL\\Desktop\\ClothingStore\\my-react-app\\src\\features\\auth\\components\\LoginView.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\NIPEAL\\Desktop\\ClothingStore\\my-react-app\\src\\features\\auth\\services\\authService.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\NIPEAL\\Desktop\\ClothingStore\\my-react-app\\src\\features\\common\\services\\notificationService.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\NIPEAL\\Desktop\\ClothingStore\\my-react-app\\src\\features\\shop\\ShopLayout.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'Icon' is defined but never used.","line":13,"column":32,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":36,"suggestions":[{"messageId":"removeVar","data":{"varName":"Icon"},"fix":{"range":[376,388],"text":""},"desc":"Remove unused variable 'Icon'."}]},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\n  67 |\n  68 |         <nav style={{ flex: 1 }}>\n> 69 |           <NavItem to=\"/shop\" icon={ShoppingCart} label=\"Register\" />\n     |            ^^^^^^^ This component is created during render\n  70 |           <NavItem to=\"/shop/history\" icon={Clock} label=\"History\" />\n  71 |         </nav>\n  72 |\n\n  11 |   };\n  12 |\n> 13 |   const NavItem = ({ to, icon: Icon, label }) => (\n     |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 14 |     <NavLink \n     | ^^^^^^^^^^^^^\n> 15 |       to={to} \n     ΓÇª\n     | ^^^^^^^^^^^^^\n> 34 |     </NavLink>\n     | ^^^^^^^^^^^^^\n> 35 |   );\n     | ^^^^ The component is created during render here\n  36 |\n  37 |   return (\n  38 |     <div style={{ display: 'flex', height: '100vh', flexDirection: 'row', overflow: 'hidden', background: '#111' }}>","line":69,"column":12,"nodeType":null,"endLine":69,"endColumn":19},{"ruleId":"react-hooks/static-components","severity":2,"message":"Error: Cannot create components during render\n\nComponents created during render will reset their state each time they are created. Declare components outside of render.\n\n  68 |         <nav style={{ flex: 1 }}>\n  69 |           <NavItem to=\"/shop\" icon={ShoppingCart} label=\"Register\" />\n> 70 |           <NavItem to=\"/shop/history\" icon={Clock} label=\"History\" />\n     |            ^^^^^^^ This component is created during render\n  71 |         </nav>\n  72 |\n  73 |         <button \n\n  11 |   };\n  12 |\n> 13 |   const NavItem = ({ to, icon: Icon, label }) => (\n     |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 14 |     <NavLink \n     | ^^^^^^^^^^^^^\n> 15 |       to={to} \n     ΓÇª\n     | ^^^^^^^^^^^^^\n> 34 |     </NavLink>\n     | ^^^^^^^^^^^^^\n> 35 |   );\n     | ^^^^ The component is created during render here\n  36 |\n  37 |   return (\n  38 |     <div style={{ display: 'flex', height: '100vh', flexDirection: 'row', overflow: 'hidden', background: '#111' }}>","line":70,"column":12,"nodeType":null,"endLine":70,"endColumn":19}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Outlet, NavLink, useNavigate } from 'react-router-dom';\r\nimport { ShoppingCart, Clock, LogOut, Menu } from 'lucide-react';\r\nimport { useState } from 'react';\r\n\r\nconst ShopLayout = () => {\r\n  const navigate = useNavigate();\r\n  const [collapsed, setCollapsed] = useState(true);\r\n\r\n  const handleLogout = () => {\r\n    navigate('/login');\r\n  };\r\n\r\n  const NavItem = ({ to, icon: Icon, label }) => (\r\n    <NavLink \r\n      to={to} \r\n      className={({ isActive }) => `btn ${isActive ? 'active' : ''}`}\r\n      style={({ isActive }) => ({\r\n        width: '100%',\r\n        height: '50px',\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: collapsed ? 'center' : 'flex-start',\r\n        padding: collapsed ? '0' : '0 16px',\r\n        background: isActive ? 'rgba(255,255,255,0.1)' : 'transparent',\r\n        color: isActive ? '#FFF' : 'rgba(255,255,255,0.6)',\r\n        marginBottom: '8px',\r\n        borderRadius: '12px',\r\n        transition: 'all 0.2s',\r\n        border: isActive ? '1px solid rgba(255,255,255,0.2)' : 'none'\r\n      })}\r\n    >\r\n      <Icon size={24} />\r\n      {!collapsed && <span style={{ marginLeft: '12px', fontWeight: 600 }}>{label}</span>}\r\n    </NavLink>\r\n  );\r\n\r\n  return (\r\n    <div style={{ display: 'flex', height: '100vh', flexDirection: 'row', overflow: 'hidden', background: '#111' }}>\r\n      \r\n      {/* Dark Minimal Sidebar */}\r\n      <aside style={{ \r\n        width: collapsed ? '80px' : '200px', \r\n        background: '#1C1C1E', \r\n        borderRight: '1px solid #333',\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        padding: '16px',\r\n        transition: 'width 0.3s ease',\r\n        zIndex: 50\r\n      }}>\r\n        {/* Toggle / Brand */}\r\n        <div \r\n          onClick={() => setCollapsed(!collapsed)}\r\n          style={{ \r\n            height: '50px', display: 'flex', alignItems: 'center', justifyContent: 'center', \r\n            marginBottom: '32px', cursor: 'pointer', color: '#FFF' \r\n          }}\r\n        >\r\n          {collapsed ? (\r\n            <div style={{ padding: '8px', background: '#007AFF', borderRadius: '8px' }}>\r\n              <span style={{ fontWeight: 'bold' }}>V</span>\r\n            </div>\r\n          ) : (\r\n             <span style={{ fontWeight: 'bold', fontSize: '18px', letterSpacing: '1px' }}>VENTA POS</span>\r\n          )}\r\n        </div>\r\n\r\n        <nav style={{ flex: 1 }}>\r\n          <NavItem to=\"/shop\" icon={ShoppingCart} label=\"Register\" />\r\n          <NavItem to=\"/shop/history\" icon={Clock} label=\"History\" />\r\n        </nav>\r\n\r\n        <button \r\n          onClick={handleLogout}\r\n          className=\"btn\"\r\n          style={{ \r\n            color: '#FF453A', \r\n            justifyContent: collapsed ? 'center' : 'flex-start',\r\n            padding: collapsed ? '0' : '0 16px',\r\n            height: '50px',\r\n            background: 'transparent'\r\n          }}\r\n        >\r\n          <LogOut size={24} />\r\n          {!collapsed && <span style={{ marginLeft: '12px' }}>Sign Out</span>}\r\n        </button>\r\n      </aside>\r\n\r\n      {/* Main Content Area - Dark Mode Default */}\r\n      <main style={{ flex: 1, overflow: 'hidden', position: 'relative', background: '#000' }}>\r\n        <Outlet />\r\n      </main>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ShopLayout;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\NIPEAL\\Desktop\\ClothingStore\\my-react-app\\src\\features\\shop\\dashboard\\ReceiptTemplate.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'date' is defined but never used.","line":3,"column":73,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":77,"suggestions":[{"messageId":"removeVar","data":{"varName":"date"},"fix":{"range":[100,106],"text":""},"desc":"Remove unused variable 'date'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\n\r\nexport const ReceiptTemplate = ({ cart, total, currency, paymentMethod, date, branchInfo }) => {\r\n  return (\r\n    <div id=\"receipt-print-area\" style={{ display: 'none' }}>\r\n      <style>\r\n        {`\r\n          @media print {\r\n            body * {\r\n              visibility: hidden;\r\n            }\r\n            #receipt-print-area, #receipt-print-area * {\r\n              visibility: visible;\r\n            }\r\n            #receipt-print-area {\r\n              position: absolute;\r\n              left: 0;\r\n              top: 0;\r\n              width: 100%;\r\n              display: block !important;\r\n              color: black;\r\n              background: white;\r\n              font-family: 'Courier New', monospace;\r\n              font-size: 12px;\r\n            }\r\n            @page {\r\n              margin: 0;\r\n              size: auto;\r\n            }\r\n          }\r\n        `}\r\n      </style>\r\n      \r\n      <div style={{ padding: '20px', maxWidth: '300px', margin: '0 auto', textAlign: 'center' }}>\r\n        {/* HEADER */}\r\n        <h2 style={{ margin: '0 0 5px 0', fontSize: '16px', fontWeight: 'bold' }}>CLOTHING STORE</h2>\r\n        <div style={{ marginBottom: '10px' }}>\r\n            <div>Branch: {branchInfo?.name || 'Main Branch'}</div>\r\n            <div>{new Date().toLocaleString()}</div>\r\n        </div>\r\n\r\n        <div style={{ borderBottom: '1px dashed #000', margin: '10px 0' }} />\r\n\r\n        {/* ITEMS */}\r\n        <div style={{ textAlign: 'left' }}>\r\n          {cart.map((item, index) => {\r\n            const itemPrice = Number(item.sellPrice || item.price || 0);\r\n            const itemTotal = (itemPrice * item.qty).toFixed(2);\r\n            return (\r\n              <div key={index} style={{ marginBottom: '5px' }}>\r\n                <div style={{ fontWeight: 'bold' }}>{item.name}</div>\r\n                <div style={{ display: 'flex', justifyContent: 'space-between' }}>\r\n                  <span>{item.qty} x ${itemPrice.toFixed(2)}</span>\r\n                  <span>${itemTotal}</span>\r\n                </div>\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n\r\n        <div style={{ borderBottom: '1px dashed #000', margin: '10px 0' }} />\r\n\r\n        {/* TOTALS */}\r\n        <div style={{ display: 'flex', justifyContent: 'space-between', fontWeight: 'bold', fontSize: '14px' }}>\r\n          <span>TOTAL ({currency})</span>\r\n          <span>{total}</span>\r\n        </div>\r\n        \r\n        <div style={{ display: 'flex', justifyContent: 'space-between', marginTop: '5px', fontSize: '12px' }}>\r\n          <span>Payment</span>\r\n          <span>{paymentMethod}</span>\r\n        </div>\r\n\r\n        <div style={{ borderBottom: '1px dashed #000', margin: '10px 0' }} />\r\n\r\n        {/* FOOTER */}\r\n        <div style={{ textAlign: 'center', marginTop: '15px' }}>\r\n          <div>Thank you for shopping!</div>\r\n          <div>Returns within 30 days</div>\r\n        </div>\r\n        \r\n        <div style={{ marginTop: '20px', textAlign: 'center' }}>\r\n            *** CUSTOMER COPY ***\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\NIPEAL\\Desktop\\ClothingStore\\my-react-app\\src\\features\\shop\\dashboard\\ShopDashboard.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[276,283],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'scanning' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":24,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"scanning"},"fix":{"range":[1252,1260],"text":""},"desc":"Remove unused variable 'scanning'."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'DEFAULT_METHODS' and 'user?.branchId'. Either include them or remove the dependency array.","line":85,"column":6,"nodeType":"ArrayExpression","endLine":85,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [DEFAULT_METHODS, user?.branchId]","fix":{"range":[3892,3894],"text":"[DEFAULT_METHODS, user?.branchId]"}}]},{"ruleId":"no-unused-vars","severity":2,"message":"'type' is defined but never used.","line":156,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":156,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"type"},"fix":{"range":[5891,5895],"text":""},"desc":"Remove unused variable 'type'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useRef } from 'react';\r\nimport { Calculator, X, Search, QrCode, CreditCard, Banknote, ShoppingBag, Delete, Check, Minus, Plus, Trash2 } from 'lucide-react';\r\nimport { useNotification } from '../../../components/ui/NotificationContext';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\nimport { inventoryService } from '../../warehouse/inventory/inventoryService';\r\nimport { salesService } from '../services/salesService';\r\nimport { ReceiptTemplate } from './ReceiptTemplate';\r\nimport { notificationService } from '../../common/services/notificationService'; // Ensure this path is correct relative to ShopDashboard\r\n\r\nimport { useAuth } from '../../../features/auth/AuthContext';\r\n\r\nconst ShopDashboard = () => {\r\n  const { user } = useAuth();\r\n  // --- STATE ---\r\n  const [cart, setCart] = useState([]);\r\n  const [scanInput, setScanInput] = useState('');\r\n  const [lastScanned, setLastScanned] = useState(null);\r\n  const [paymentMethods, setPaymentMethods] = useState([]);\r\n  const [selectedMethod, setSelectedMethod] = useState(null);\r\n  const [currentBranchId, setCurrentBranchId] = useState(user?.branchId || '1');\r\n  const [currentBranchName, setCurrentBranchName] = useState('Loading...');\r\n  \r\n  const [scanning, setScanning] = useState(false);\r\n  const [processing, setProcessing] = useState(false);\r\n  \r\n  const { showNotification } = useNotification();\r\n  \r\n  // Default fallback if fetch fails\r\n  const DEFAULT_METHODS = [\r\n    { id: 'cash', name: 'Cash', icon: '≡ƒÆ╡', currency: 'USD' },\r\n    { id: 'card', name: 'Card', icon: '≡ƒÆ│', currency: 'USD' }\r\n  ];\r\n\r\n  // Ref for auto-focusing the hidden input\r\n  const inputRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n      const loadConfig = async () => {\r\n          try {\r\n              const { branchService } = await import('../../warehouse/services/branchService');\r\n              \r\n              let activeBranchId = user?.branchId;\r\n\r\n              // If no branch assigned to user, fetch the first available branch\r\n              if (!activeBranchId) {\r\n                  const branches = await branchService.getBranches();\r\n                  if (branches && branches.length > 0) {\r\n                      activeBranchId = branches[0].id;\r\n                  } else {\r\n                      activeBranchId = '1'; // Ultimate fallback\r\n                  }\r\n              }\r\n\r\n              console.log(\"Loading POS settings for Branch ID:\", activeBranchId);\r\n              setCurrentBranchId(activeBranchId);\r\n              \r\n              // Find branch name for display\r\n              const branches = await branchService.getBranches();\r\n              const activeBranch = branches.find(b => b.id === activeBranchId);\r\n              setCurrentBranchName(activeBranch ? activeBranch.name : `Branch ${activeBranchId}`);\r\n\r\n              const methods = await branchService.getPaymentConfig(activeBranchId);\r\n              if (methods && methods.length > 0) {\r\n                  setPaymentMethods(methods);\r\n                  // Find 'Cash' (case insensitive) or fallback to first\r\n                  const defaultMethod = methods.find(m => m.name.toLowerCase().includes('cash')) || methods[0];\r\n                  setSelectedMethod(defaultMethod);\r\n              } else {\r\n                  setPaymentMethods(DEFAULT_METHODS);\r\n                  setSelectedMethod(DEFAULT_METHODS[0]);\r\n              }\r\n          } catch (e) {\r\n              console.error(\"Failed to load payment methods\", e);\r\n              setPaymentMethods(DEFAULT_METHODS);\r\n              setSelectedMethod(DEFAULT_METHODS[0]);\r\n          }\r\n      };\r\n      loadConfig();\r\n\r\n      inputRef.current?.focus();\r\n      const handleClickAnywhere = () => inputRef.current?.focus();\r\n      window.addEventListener('click', handleClickAnywhere);\r\n      return () => window.removeEventListener('click', handleClickAnywhere);\r\n  }, []);\r\n\r\n  // --- HANDLERS ---\r\n  const handleScan = async (e) => {\r\n    e.preventDefault();\r\n    const barcode = scanInput;\r\n    if (!barcode) return;\r\n\r\n    setScanning(true);\r\n    setScanInput(''); // Clear immediately for UX\r\n\r\n    try {\r\n      const product = await inventoryService.getProductByBarcode(barcode);\r\n      \r\n      if (product) {\r\n        if (product.stock <= 0) {\r\n            playSound('error');\r\n            alert(`Item \"${product.name}\" is OUT OF STOCK!`);\r\n            return;\r\n        }\r\n\r\n        addToCart(product);\r\n        setLastScanned(product);\r\n        playSound('success');\r\n      } else {\r\n        playSound('error'); \r\n        alert('Product not found in database!');\r\n      }\r\n    } catch (err) {\r\n      console.error(err);\r\n      playSound('error');\r\n    } finally {\r\n      setScanning(false);\r\n      inputRef.current?.focus(); // Refocus\r\n    }\r\n  };\r\n\r\n  const addToCart = (product) => {\r\n    // Sanitize data types\r\n    const safeProduct = {\r\n        ...product,\r\n        price: Number(product.price || 0),\r\n        sellPrice: Number(product.sellPrice || product.price || 0),\r\n        discount: Number(product.discount || 0),\r\n        priceIQD: Number(product.priceIQD || 0),\r\n        priceEUR: Number(product.priceEUR || 0)\r\n    };\r\n\r\n    setCart(prev => {\r\n      const existing = prev.find(item => item.barcode === product.barcode);\r\n      if (existing) {\r\n        return prev.map(item => item.barcode === product.barcode ? { ...item, qty: item.qty + 1 } : item);\r\n      }\r\n      return [...prev, { ...safeProduct, qty: 1 }];\r\n    });\r\n  };\r\n\r\n  const removeFromCart = (barcode) => {\r\n    setCart(prev => prev.filter(item => item.barcode !== barcode));\r\n  };\r\n\r\n  const updateQty = (barcode, change) => {\r\n    setCart(prev => prev.map(item => {\r\n      if (item.barcode === barcode) {\r\n        const newQty = item.qty + change;\r\n        return newQty > 0 ? { ...item, qty: newQty } : item;\r\n      }\r\n      return item;\r\n    }));\r\n  };\r\n\r\n  const playSound = (type) => {\r\n    // Console log for now\r\n  };\r\n\r\n  const handleCompleteSale = async (status = 'COMPLETED') => {\r\n    if (cart.length === 0 || (!selectedMethod && status === 'COMPLETED')) return;\r\n    \r\n    setProcessing(true);\r\n    try {\r\n        // 1. Deduct Stock\r\n        await inventoryService.processSale(cart);\r\n        \r\n        // 2. Record Sale\r\n        await salesService.createSale({\r\n            items: cart,\r\n            total: grandTotalUSD, // Note: storing number. Currency stored separately.\r\n            currency: status === 'ORDER' ? 'USD' : (selectedMethod?.currency || 'USD'),\r\n            paymentMethod: status === 'ORDER' ? 'Pay Later' : selectedMethod.name,\r\n            paymentMethodId: status === 'ORDER' ? 'order' : selectedMethod.id,\r\n            status: status, // 'COMPLETED' or 'ORDER'\r\n            branchId: currentBranchId, \r\n            adminId: user?.id || 'staff',\r\n            adminName: user?.name || user?.username || 'Staff', \r\n        });\r\n        \r\n        const successMsg = status === 'ORDER' ? 'Order Saved!' : 'Sale Completed!';\r\n        console.log(`${successMsg} Total: ${grandTotalUSD}`);\r\n        playSound('success');\r\n\r\n        // Reset UI\r\n        setCart([]);\r\n        setLastScanned(null);\r\n        showNotification(`${successMsg} ${formatUSD(grandTotalUSD)}`, 'success');\r\n        \r\n        // --- TRIGGER PRINT if Sale ---\r\n        if (status === 'COMPLETED') {\r\n            setTimeout(() => {\r\n                window.print();\r\n            }, 500);\r\n        }\r\n        \r\n    } catch (error) {\r\n        showNotification(error.message, 'error');\r\n        playSound('error');\r\n    } finally {\r\n        setProcessing(false);\r\n        inputRef.current?.focus();\r\n    }\r\n  };\r\n\r\n  const handleCloseRegister = async () => {\r\n      if (!window.confirm(\"Are you sure you want to CLOSE the register for today? This will generate a report for the admin.\")) return;\r\n\r\n      try {\r\n          // In a real app we'd fetch actual sales from DB for the day to be accurate\r\n          // For now, we'll just notify that the shift is closed. \r\n          // Ideally: const dailyStats = await salesService.getBranchStats(branchId);\r\n          \r\n          await notificationService.createNotification(\r\n              'SHIFT_REPORT',\r\n              'Register Closed',\r\n              `Shift closed by ${user?.name || 'Staff'}. Check daily sales report for details.`,\r\n              {\r\n                  closer: user?.name,\r\n                  time: new Date().toISOString()\r\n              },\r\n              currentBranchId\r\n          );\r\n          \r\n          showNotification(\"Register Closed. Report sent to Admin.\", \"success\");\r\n      } catch (e) {\r\n          console.error(e);\r\n          showNotification(\"Failed to send report\", \"error\");\r\n      }\r\n  };\r\n\r\n  // --- CALCULATIONS ---\r\n  // Calculates totals for ALL currencies simultaneously\r\n  const totals = cart.reduce((acc, item) => {\r\n      const discount = (Number(item.discount) || 0) / 100;\r\n      \r\n      const priceUSD = Number(item.sellPrice || item.price || 0); // sellPrice is USD base\r\n      const priceIQD = Number(item.priceIQD || 0);\r\n      const priceEUR = Number(item.priceEUR || 0);\r\n\r\n      acc.usd += (priceUSD * (1 - discount)) * item.qty;\r\n      acc.iqd += (priceIQD * (1 - discount)) * item.qty; // Note: If priceIQD is 0, it adds 0\r\n      acc.eur += (priceEUR * (1 - discount)) * item.qty;\r\n      \r\n      return acc;\r\n  }, { usd: 0, iqd: 0, eur: 0 });\r\n\r\n  const taxUSD = totals.usd * 0.05; \r\n  const grandTotalUSD = totals.usd + taxUSD;\r\n\r\n  // Formatting helpers\r\n  const formatUSD = (v) => `$${v.toLocaleString(undefined, {minimumFractionDigits: 2})}`;\r\n  const formatIQD = (v) => `${v.toLocaleString()} IQD`;\r\n  const formatEUR = (v) => `Γé¼${v.toLocaleString(undefined, {minimumFractionDigits: 2})}`;\r\n\r\n// Main Component Return Wrapper\r\n  return (\r\n    <div className=\"layout-container\" style={{ height: '100vh', display: 'grid', gridTemplateColumns: '1fr 400px', background: '#09090b', overflow: 'hidden' }}>\r\n      \r\n      {/* LEFT COLUMN: ACTIVE CART (65%) */}\r\n      <div style={{ flex: '65%', padding: '24px', display: 'flex', flexDirection: 'column', borderRight: '1px solid #27272a' }}>\r\n        \r\n        <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '24px', alignItems: 'center' }}>\r\n           <form onSubmit={handleScan} style={{ flex: 1, maxWidth: '400px', position: 'relative' }}>\r\n             <Search size={20} style={{ position: 'absolute', left: '16px', top: '14px', color: '#71717a' }} />\r\n             <input \r\n               ref={inputRef}\r\n               className=\"scanner-input\"\r\n               value={scanInput}\r\n               onChange={e => setScanInput(e.target.value)}\r\n               placeholder={`Scan in ${currentBranchName}...`}\r\n               style={{ \r\n                 width: '100%', padding: '14px 14px 14px 48px', borderRadius: '16px', \r\n                 background: '#18181b', border: '1px solid #27272a', color: '#FFF', fontSize: '16px',\r\n                 outline: 'none', boxShadow: '0 4px 6px -1px rgba(0, 0, 0, 0.1)'\r\n               }}\r\n             />\r\n             <div style={{ position: 'absolute', right: '12px', top: '14px', color: '#555', fontSize: '11px', fontWeight: 600, background: '#111', padding: '2px 8px', borderRadius: '4px' }}>\r\n                 {currentBranchName}\r\n             </div>\r\n           </form>\r\n\r\n           {/* LARGE LAST ITEM DISPLAY */}\r\n           {lastScanned && (\r\n             <motion.div \r\n               initial={{ scale: 0.9, opacity: 0, y: 10 }}\r\n               animate={{ scale: 1, opacity: 1, y: 0 }}\r\n               key={lastScanned.barcode}\r\n               style={{ \r\n                 background: 'linear-gradient(135deg, #007AFF 0%, #0055FF 100%)', \r\n                 padding: '12px 24px', borderRadius: '16px', \r\n                 display: 'flex', alignItems: 'center', gap: '20px', \r\n                 boxShadow: '0 10px 25px -5px rgba(0, 122, 255, 0.3)'\r\n               }}\r\n             >\r\n               {lastScanned.imageUrl && (\r\n                 <img \r\n                   src={lastScanned.imageUrl} \r\n                   alt=\"Last Scanned\" \r\n                   style={{ width: '50px', height: '50px', borderRadius: '10px', objectFit: 'cover', border: '2px solid rgba(255,255,255,0.3)' }} \r\n                 />\r\n               )}\r\n               <div>\r\n                  <div style={{ fontSize: '11px', textTransform: 'uppercase', opacity: 0.8, fontWeight: 600, letterSpacing: '0.5px' }}>Last Scanned</div>\r\n                  <div style={{ fontWeight: '700', fontSize: '15px' }}>{lastScanned.name}</div>\r\n               </div>\r\n               <div style={{ textAlign: 'right', marginLeft: 'auto' }}>\r\n                 {lastScanned.discount > 0 && (\r\n                   <div style={{ fontSize: '14px', opacity: 0.7, textDecoration: 'line-through' }}>${lastScanned.price}</div>\r\n                 )}\r\n                 <div style={{ fontSize: '28px', fontWeight: '800', letterSpacing: '-1px' }}>\r\n                   {formatUSD(lastScanned.price * (1 - (lastScanned.discount || 0) / 100))}\r\n                 </div>\r\n               </div>\r\n             </motion.div>\r\n           )}\r\n        </div>\r\n\r\n        {/* Cart List */}\r\n        <div style={{ flex: 1, overflowY: 'auto', paddingRight: '8px' }}>\r\n          <AnimatePresence>\r\n            {cart.map(item => (\r\n              <motion.div \r\n                key={item.barcode}\r\n                initial={{ x: -20, opacity: 0 }}\r\n                animate={{ x: 0, opacity: 1 }}\r\n                exit={{ x: -20, opacity: 0 }}\r\n                style={{ \r\n                  display: 'flex', alignItems: 'center', justifyContent: 'space-between',\r\n                  padding: '16px 20px', marginBottom: '12px', background: '#18181b', borderRadius: '16px',\r\n                  border: '1px solid #27272a' \r\n                }}\r\n              >\r\n                <div style={{ display: 'flex', alignItems: 'center', gap: '20px' }}>\r\n                  <div style={{ \r\n                    width: '48px', height: '48px', background: '#27272a', borderRadius: '12px', \r\n                    display: 'flex', alignItems: 'center', justifyContent: 'center', overflow: 'hidden'\r\n                  }}>\r\n                     {item.imageUrl ? (\r\n                       <img src={item.imageUrl} alt={item.name} style={{ width: '100%', height: '100%', objectFit: 'cover' }} />\r\n                     ) : (\r\n                       <ShoppingBag size={20} color=\"#a1a1aa\" />\r\n                     )}\r\n                  </div>\r\n                  <div>\r\n                    <div style={{ fontWeight: '600', fontSize: '16px', color: '#f4f4f5' }}>{item.name}</div>\r\n                    <div style={{ color: '#a1a1aa', fontSize: '13px', marginTop: '2px' }}>\r\n                      #{item.barcode} ΓÇó \r\n                      {item.discount > 0 ? (\r\n                        <span>\r\n                          <span style={{ textDecoration: 'line-through', marginRight: '6px' }}>${item.price}</span>\r\n                          <span style={{ color: '#34C759', fontWeight: 'bold' }}>${(item.price * (1 - item.discount / 100)).toFixed(2)}</span>\r\n                        </span>\r\n                      ) : (\r\n                        ` $${item.price}`\r\n                      )}\r\n                       each\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div style={{ display: 'flex', alignItems: 'center', gap: '32px' }}>\r\n                  {/* Qty Control */}\r\n                  <div style={{ display: 'flex', alignItems: 'center', gap: '4px', background: '#000', borderRadius: '12px', padding: '4px', border: '1px solid #27272a' }}>\r\n                    <button onClick={() => updateQty(item.barcode, -1)} className=\"btn-icon-small\" style={{ width: '32px', height: '32px' }}><Minus size={16}/></button>\r\n                    <span style={{ fontWeight: 'bold', width: '32px', textAlign: 'center', fontSize: '15px' }}>{item.qty}</span>\r\n                    <button onClick={() => updateQty(item.barcode, 1)} className=\"btn-icon-small\" style={{ width: '32px', height: '32px' }}><Plus size={16}/></button>\r\n                  </div>\r\n                  \r\n                  <div style={{ fontWeight: '700', fontSize: '18px', width: '80px', textAlign: 'right', color: '#fff' }}>\r\n                    ${((item.price * (1 - (item.discount || 0) / 100)) * item.qty).toFixed(2)}\r\n                  </div>\r\n                  \r\n                  <button \r\n                    onClick={() => removeFromCart(item.barcode)} \r\n                    style={{ \r\n                      background: 'rgba(255, 69, 58, 0.1)', border: 'none', borderRadius: '8px',\r\n                      color: '#FF453A', cursor: 'pointer', padding: '8px', display: 'flex' \r\n                    }}\r\n                  >\r\n                    <Trash2 size={18} />\r\n                  </button>\r\n                </div>\r\n              </motion.div>\r\n            ))}\r\n          </AnimatePresence>\r\n          \r\n          {cart.length === 0 && (\r\n            <div style={{ height: '100%', display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center', color: '#52525b' }}>\r\n              <div style={{ padding: '24px', background: '#18181b', borderRadius: '50%', marginBottom: '24px', border: '1px solid #27272a' }}>\r\n                <ShoppingBag size={48} opacity={0.5} />\r\n              </div>\r\n              <div style={{ fontSize: '20px', fontWeight: '600', marginBottom: '8px' }}>Register Ready</div>\r\n              <div style={{ fontSize: '14px' }}>Scan product barcode to begin sale</div>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n      </div>\r\n\r\n      {/* RIGHT COLUMN: CONTROLS & TOTALS (35%) */}\r\n      <div style={{ flex: '35%', background: '#18181b', padding: '32px', display: 'flex', flexDirection: 'column', borderLeft: '1px solid #000' }}>\r\n        \r\n       {/* Payment Methods */}\r\n        <div style={{ marginBottom: 'auto' }}>\r\n           <h3 style={{ fontSize: '13px', textTransform: 'uppercase', color: '#a1a1aa', fontWeight: 700, letterSpacing: '1px', marginBottom: '20px' }}>Select Payment Method</h3>\r\n           <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px' }}>\r\n             {paymentMethods.map(method => (\r\n               <PaymentButton \r\n                 key={method.id}\r\n                 label={method.name} \r\n                 icon={method.icon} \r\n                 color={method.currency === 'USD' ? '#34C759' : '#007AFF'} \r\n                 isSelected={selectedMethod?.id === method.id}\r\n                 onClick={() => setSelectedMethod(method)}\r\n               />\r\n             ))}\r\n           </div>\r\n        </div>\r\n\r\n        {/* Totals Section */}\r\n        <div style={{ marginTop: '32px', background: '#09090b', borderRadius: '24px', padding: '24px', border: '1px solid #27272a' }}>\r\n          <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '12px', color: '#a1a1aa', fontSize: '14px' }}>\r\n            <span>Subtotal (USD)</span>\r\n            <span>{formatUSD(totals.usd)}</span>\r\n          </div>\r\n          \r\n          <div style={{ height: '1px', background: '#27272a', marginBottom: '24px' }} />\r\n\r\n          {/* MULTI-CURRENCY DISPLAY */}\r\n          <div style={{ marginBottom: '32px', display: 'flex', flexDirection: 'column', gap: '12px' }}>\r\n             \r\n             {/* USD TOTAL */}\r\n             <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n                <span style={{ fontSize: '14px', fontWeight: '600', color: '#888' }}>Total USD</span>\r\n                <span style={{ fontSize: '24px', fontWeight: '700', color: '#34C759' }}>{formatUSD(grandTotalUSD)}</span>\r\n             </div>\r\n\r\n             {/* IQD TOTAL */}\r\n             <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n                <span style={{ fontSize: '14px', fontWeight: '600', color: '#888' }}>Total IQD</span>\r\n                <span style={{ fontSize: '24px', fontWeight: '700', color: '#007AFF' }}>{formatIQD(totals.iqd)}</span>\r\n             </div>\r\n\r\n             {/* EUR TOTAL */}\r\n             <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n                <span style={{ fontSize: '14px', fontWeight: '600', color: '#888' }}>Total EUR</span>\r\n                <span style={{ fontSize: '24px', fontWeight: '700', color: '#FF9500' }}>{formatEUR(totals.eur)}</span>\r\n             </div>\r\n\r\n          </div>\r\n\r\n          <button \r\n            onClick={() => handleCompleteSale('COMPLETED')}\r\n            disabled={cart.length === 0 || processing}\r\n            style={{ \r\n              width: '100%', padding: '24px', borderRadius: '16px', border: 'none',\r\n              background: cart.length > 0 ? 'linear-gradient(135deg, #007AFF 0%, #0066CC 100%)' : '#27272a', \r\n              color: cart.length > 0 ? '#FFF' : '#71717a',\r\n              fontSize: '18px', fontWeight: '700', \r\n              cursor: cart.length > 0 && !processing ? 'pointer' : 'not-allowed',\r\n              opacity: cart.length > 0 && !processing ? 1 : 0.8,\r\n              transition: 'all 0.2s',\r\n              boxShadow: cart.length > 0 ? '0 10px 30px -10px rgba(0,122,255,0.5)' : 'none',\r\n              transform: cart.length > 0 ? 'translateY(0)' : 'none'\r\n            }}\r\n          >\r\n            {processing ? 'Processing...' : (cart.length > 0 ? `Charge ${formatUSD(grandTotalUSD)}` : 'Cart Empty')}\r\n          </button>\r\n          \r\n          <div style={{ display: 'flex', gap: '12px', marginTop: '16px' }}>\r\n             <button \r\n               onClick={() => handleCompleteSale('ORDER')}\r\n               disabled={cart.length === 0 || processing}\r\n               style={{ flex: 1, padding: '16px', background: '#27272a', border: '1px solid #3f3f46', borderRadius: '12px', color: '#d4d4d8', fontSize: '13px', fontWeight: 600, cursor: 'pointer' }}\r\n             >\r\n               Save as Order\r\n             </button>\r\n             <button \r\n               onClick={() => { setCart([]); }} \r\n               style={{ flex: 1, padding: '16px', background: 'rgba(255, 69, 58, 0.1)', border: '1px solid rgba(255, 69, 58, 0.2)', borderRadius: '12px', color: '#FF453A', fontSize: '13px', fontWeight: 600, cursor: 'pointer' }}>\r\n               Void Transaction\r\n             </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <ReceiptTemplate \r\n        cart={cart} \r\n        total={formatUSD(grandTotalUSD)} \r\n        currency=\"USD\"\r\n        paymentMethod={selectedMethod?.name}\r\n      />\r\n      \r\n      {/* Footer / Close Register */}\r\n      <div style={{ position: 'fixed', bottom: '24px', right: '430px', zIndex: 10 }}>\r\n          <button \r\n            onClick={handleCloseRegister}\r\n            style={{ \r\n                background: '#27272a', border: '1px solid #3f3f46', borderRadius: '50px', \r\n                padding: '12px 24px', color: '#a1a1aa', fontSize: '12px', fontWeight: 600,\r\n                cursor: 'pointer', display: 'flex', alignItems: 'center', gap: '8px' \r\n            }}\r\n          >\r\n              <div style={{ width: '8px', height: '8px', borderRadius: '50%', background: '#ff453a' }}></div>\r\n              Close Register\r\n          </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// Updated Payment Button Component\r\nconst PaymentButton = ({ label, icon, color, isSelected, onClick }) => (\r\n  <button \r\n    onClick={onClick}\r\n    style={{ \r\n      padding: '24px', \r\n      background: isSelected ? `${color}15` : '#27272a', \r\n      border: isSelected ? `2px solid ${color}` : '2px solid transparent', \r\n      borderRadius: '16px', \r\n      color: '#FFF', \r\n      display: 'flex', flexDirection: 'column', alignItems: 'center', gap: '10px', \r\n      cursor: 'pointer',\r\n      transition: 'all 0.2s',\r\n      transform: isSelected ? 'scale(1.02)' : 'scale(1)',\r\n      position: 'relative'\r\n    }}\r\n  >\r\n    {isSelected && (\r\n      <motion.div \r\n        layoutId=\"selected-check\"\r\n        style={{ position: 'absolute', top: '10px', right: '10px', color: color }}\r\n      >\r\n        <div style={{ width: '8px', height: '8px', borderRadius: '50%', background: color }} />\r\n      </motion.div>\r\n    )}\r\n    <div style={{ fontSize: '28px' }}>{icon}</div>\r\n    <div style={{ fontSize: '14px', fontWeight: 700, color: isSelected ? color : '#d4d4d8' }}>{label}</div>\r\n  </button>\r\n);\r\n\r\nexport default ShopDashboard;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\NIPEAL\\Desktop\\ClothingStore\\my-react-app\\src\\features\\shop\\services\\salesService.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\NIPEAL\\Desktop\\ClothingStore\\my-react-app\\src\\features\\warehouse\\AdminSettingsView.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\NIPEAL\\Desktop\\ClothingStore\\my-react-app\\src\\features\\warehouse\\WarehouseLayout.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'Icon' is defined but never used.","line":6,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":38,"suggestions":[{"messageId":"removeVar","data":{"varName":"Icon"},"fix":{"range":[333,345],"text":""},"desc":"Remove unused variable 'Icon'."}]},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n  35 |   // Close menu on route change\n  36 |   useEffect(() => {\n> 37 |     setMobileMenuOpen(false);\n     |     ^^^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  38 |   }, [location.pathname]);\n  39 |\n  40 |   const handleLogout = () => {","line":37,"column":5,"nodeType":null,"endLine":37,"endColumn":22}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Outlet, NavLink, useNavigate, useLocation } from 'react-router-dom';\r\nimport { LayoutDashboard, Store, Package, CreditCard, LogOut, Menu, X, Settings } from 'lucide-react';\r\nimport { useState, useEffect } from 'react';\r\nimport NotificationCenter from '../../components/admin/NotificationCenter';\r\n\r\nconst SidebarItem = ({ to, icon: Icon, label, onClick }) => (\r\n  <NavLink \r\n    to={to} \r\n    onClick={onClick}\r\n    className={({ isActive }) => \r\n      `btn ${isActive ? 'active' : ''}`\r\n    }\r\n    style={({ isActive }) => ({\r\n      width: '100%',\r\n      justifyContent: 'flex-start',\r\n      padding: '12px 16px',\r\n      background: isActive ? 'var(--color-bg-app)' : 'transparent',\r\n      color: isActive ? 'var(--color-primary)' : 'var(--color-text-secondary)',\r\n      marginBottom: '8px',\r\n      borderRadius: 'var(--radius-md)',\r\n      fontWeight: isActive ? 600 : 500,\r\n      boxShadow: 'none'\r\n    })}\r\n  >\r\n    <Icon size={20} style={{ marginRight: '12px' }} />\r\n    {label}\r\n  </NavLink>\r\n);\r\n\r\nconst WarehouseLayout = () => {\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);\r\n\r\n  // Close menu on route change\r\n  useEffect(() => {\r\n    setMobileMenuOpen(false);\r\n  }, [location.pathname]);\r\n\r\n  const handleLogout = () => {\r\n    navigate('/login');\r\n  };\r\n\r\n  return (\r\n    <div style={{ display: 'flex', height: '100vh', flexDirection: 'column', overflow: 'hidden' }}>\r\n      \r\n      {/* MOBILE HEADER */}\r\n      <div className=\"mobile-only\" style={{ \r\n        padding: '16px', background: '#FFF', borderBottom: '1px solid #eee', \r\n        display: 'flex', alignItems: 'center', justifyContent: 'space-between', zIndex: 100 \r\n      }}>\r\n        <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>\r\n          <button onClick={() => setMobileMenuOpen(true)} style={{ border: 'none', background: 'transparent', padding: 0 }}>\r\n             <Menu size={24} color=\"#333\" />\r\n          </button>\r\n          <span style={{ fontWeight: 'bold', fontSize: '18px' }}>Venta Admin</span>\r\n        </div>\r\n      </div>\r\n\r\n      <div style={{ display: 'flex', flex: 1, overflow: 'hidden', position: 'relative' }}>\r\n        \r\n        {/* OVERLAY for Mobile */}\r\n        {mobileMenuOpen && (\r\n          <div \r\n            onClick={() => setMobileMenuOpen(false)}\r\n            style={{ \r\n              position: 'absolute', inset: 0, background: 'rgba(0,0,0,0.5)', zIndex: 40 \r\n            }} \r\n          />\r\n        )}\r\n\r\n        {/* SIDEBAR */}\r\n        <aside \r\n          className={mobileMenuOpen ? 'sidebar-open' : 'sidebar-closed'}\r\n          style={{ \r\n            width: '260px', \r\n            background: '#fff', \r\n            borderRight: '1px solid var(--color-border)',\r\n            display: 'flex',\r\n            flexDirection: 'column',\r\n            padding: '24px',\r\n            position: window.innerWidth <= 768 ? 'absolute' : 'relative',\r\n            height: '100%',\r\n            zIndex: 50,\r\n            transform: (window.innerWidth <= 768 && !mobileMenuOpen) ? 'translateX(-100%)' : 'translateX(0)',\r\n            transition: 'transform 0.3s ease',\r\n            boxShadow: mobileMenuOpen ? '4px 0 24px rgba(0,0,0,0.1)' : 'none'\r\n          }}\r\n        >\r\n          <div style={{ marginBottom: '40px', paddingLeft: '16px', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n            <div>\r\n              <h2 style={{ fontSize: '20px', fontWeight: 'bold', color: 'var(--color-primary)', display: 'flex', alignItems: 'center', gap: '8px' }}>\r\n                <span style={{ background: 'var(--color-primary)', color: 'white', borderRadius: '6px', padding: '2px 6px', fontSize: '14px' }}>W</span>\r\n                Venta\r\n              </h2>\r\n              <span style={{ fontSize: '12px', color: '#999', fontWeight: 500 }}>Warehouse Admin</span>\r\n            </div>\r\n            {/* Close but only visible on mobile inside sidebar */}\r\n            {mobileMenuOpen && (\r\n              <button \r\n                onClick={() => setMobileMenuOpen(false)}\r\n                className=\"btn mobile-only\" \r\n                style={{ padding: '8px', background: '#F5F5F7' }}\r\n              >\r\n                <X size={20} />\r\n              </button>\r\n            )}\r\n          </div>\r\n\r\n          <nav style={{ flex: 1 }}>\r\n            <SidebarItem to=\"/warehouse\" icon={LayoutDashboard} label=\"Dashboard\" />\r\n            <SidebarItem to=\"/warehouse/branches\" icon={Store} label=\"Branches\" />\r\n            <SidebarItem to=\"/warehouse/settings\" icon={Settings} label=\"Settings\" />\r\n          </nav>\r\n\r\n          <button \r\n            onClick={handleLogout}\r\n            className=\"btn\"\r\n            style={{ \r\n              justifyContent: 'flex-start', \r\n              color: 'var(--color-error)', \r\n              padding: '12px 16px',\r\n              background: 'transparent',\r\n              marginTop: 'auto' \r\n            }}\r\n          >\r\n            <LogOut size={20} style={{ marginRight: '12px' }} />\r\n            Sign Out\r\n          </button>\r\n        </aside>\r\n\r\n        {/* Main Content Area with Header */}\r\n        <div style={{ flex: 1, display: 'flex', flexDirection: 'column', overflow: 'hidden' }}>\r\n            <header style={{ \r\n                height: '64px', background: '#FFF', borderBottom: '1px solid var(--color-border)', \r\n                display: 'flex', alignItems: 'center', justifyContent: 'flex-end', padding: '0 32px' \r\n            }}>\r\n                <NotificationCenter />\r\n                <div style={{ width: '1px', height: '20px', background: '#EEE', margin: '0 20px' }} />\r\n                <div style={{ fontSize: '13px', fontWeight: 600, color: '#333' }}>Admin</div>\r\n            </header>\r\n            <main className=\"main-content\" style={{ flex: 1, overflowY: 'auto', padding: '32px', background: 'var(--color-bg-app)' }}>\r\n              <Outlet />\r\n            </main>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default WarehouseLayout;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\NIPEAL\\Desktop\\ClothingStore\\my-react-app\\src\\features\\warehouse\\branches\\BranchActionsView.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\NIPEAL\\Desktop\\ClothingStore\\my-react-app\\src\\features\\warehouse\\branches\\BranchDetailView.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[240,279],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'Icon' is defined but never used.","line":341,"column":48,"nodeType":"Identifier","messageId":"unusedVar","endLine":341,"endColumn":52,"suggestions":[{"messageId":"removeVar","data":{"varName":"Icon"},"fix":{"range":[13775,13787],"text":""},"desc":"Remove unused variable 'Icon'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'Icon' is defined but never used.","line":367,"column":46,"nodeType":"Identifier","messageId":"unusedVar","endLine":367,"endColumn":50,"suggestions":[{"messageId":"removeVar","data":{"varName":"Icon"},"fix":{"range":[14841,14853],"text":""},"desc":"Remove unused variable 'Icon'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useParams, useNavigate } from 'react-router-dom';\r\nimport { ArrowLeft, TrendingUp, ShoppingBag, DollarSign, Plus, Users, Package, Activity, CreditCard, Calendar } from 'lucide-react';\r\nimport { useState, useEffect } from 'react';\r\nimport { motion } from 'framer-motion';\r\nimport { \r\n  AreaChart, Area, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer,\r\n  PieChart, Pie, Cell, Legend\r\n} from 'recharts';\r\n\r\nimport { branchService } from '../services/branchService';\r\nimport { salesService } from '../../shop/services/salesService';\r\nimport { inventoryService } from '../inventory/inventoryService';\r\nimport { authService } from '../../auth/services/authService';\r\n\r\n// --- MOCK DATA FOR CHARTS ---\r\nconst SALES_DATA = [\r\n  { name: 'Mon', sales: 4000 },\r\n  { name: 'Tue', sales: 3000 },\r\n  { name: 'Wed', sales: 5000 },\r\n  { name: 'Thu', sales: 2780 },\r\n  { name: 'Fri', sales: 1890 },\r\n  { name: 'Sat', sales: 6390 },\r\n  { name: 'Sun', sales: 3490 },\r\n];\r\n\r\nconst CATEGORY_DATA = [\r\n  { name: 'Suits', value: 400, color: '#0088FE' },\r\n  { name: 'Shoes', value: 300, color: '#00C49F' },\r\n  { name: 'Shirts', value: 300, color: '#FFBB28' },\r\n  { name: 'Access.', value: 200, color: '#FF8042' },\r\n];\r\n\r\nimport { useAuth } from '../../auth/AuthContext';\r\nimport { ROLES } from '../../auth/services/authService';\r\n\r\n// ...\r\n\r\nconst BranchDetailView = () => {\r\n  const { branchId } = useParams();\r\n  const navigate = useNavigate();\r\n  const { user, hasPermission } = useAuth();\r\n  const isAdmin = user?.role === 'admin'; // Or ROLES.ADMIN if available\r\n\r\n  const [branch, setBranch] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  const [stats, setStats] = useState({\r\n    revenue: 0,\r\n    orders: 0,\r\n    stock: 0,\r\n    employees: 0\r\n  });\r\n\r\n  const [chartData, setChartData] = useState([]);\r\n  const [categoryData, setCategoryData] = useState([]);\r\n\r\n  useEffect(() => {\r\n    const loadDashboardData = async () => {\r\n      try {\r\n        // 1. Load Branch Info\r\n        const branches = await branchService.getBranches();\r\n        const found = branches.find(b => b.id.toString() === branchId) || { name: 'Unknown Branch', id: branchId };\r\n        setBranch(found);\r\n\r\n        // 2. Load Sales Stats (Revenue & Orders & Chart)\r\n        const salesData = await salesService.getBranchStats(branchId);\r\n        setChartData(salesData.chartData); // Real Sales Data\r\n        \r\n        // 3. Load Inventory Stats (Stock Count & Category Split)\r\n        const inventory = await inventoryService.getBranchInventory(branchId);\r\n        const totalStock = inventory.reduce((acc, item) => acc + (Number(item.stock) || 0), 0);\r\n        \r\n        // Compute Category Split\r\n        const catMap = {};\r\n        inventory.forEach(item => {\r\n            const cat = item.category || 'Uncategorized';\r\n            catMap[cat] = (catMap[cat] || 0) + (Number(item.stock) || 0);\r\n        });\r\n        \r\n        const COLORS = ['#0088FE', '#00C49F', '#FFBB28', '#FF8042', '#8884d8'];\r\n        const activeCategories = Object.keys(catMap).map((cat, idx) => ({\r\n            name: cat,\r\n            value: catMap[cat],\r\n            color: COLORS[idx % COLORS.length]\r\n        }));\r\n        setCategoryData(activeCategories);\r\n\r\n        // 4. Load Employee Stats\r\n        const employees = await authService.getEmployees();\r\n        \r\n        setStats({\r\n          revenue: salesData.totalRevenue,\r\n          orders: salesData.orderCount,\r\n          stock: totalStock,\r\n          employees: employees.length\r\n        });\r\n\r\n      } catch (error) {\r\n        console.error(\"Dashboard Load Error\", error);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    loadDashboardData();\r\n  }, [branchId]);\r\n\r\n  if (loading) return <div style={{ padding: '40px', textAlign: 'center' }}>Loading Dashboard...</div>;\r\n\r\n  // Animation Variants\r\n  const containerVariants = {\r\n    hidden: { opacity: 0 },\r\n    visible: { opacity: 1, transition: { staggerChildren: 0.1 } }\r\n  };\r\n\r\n  const itemVariants = {\r\n    hidden: { y: 20, opacity: 0 },\r\n    visible: { y: 0, opacity: 1 }\r\n  };\r\n\r\n  return (\r\n    <motion.div \r\n      initial=\"hidden\"\r\n      animate=\"visible\"\r\n      variants={containerVariants}\r\n      style={{ maxWidth: '1200px', margin: '0 auto', paddingBottom: '40px' }}\r\n    >\r\n      {/* HEADER */}\r\n      <motion.div \r\n        variants={itemVariants}\r\n        style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '32px' }}\r\n      >\r\n        <div style={{ display: 'flex', alignItems: 'center', gap: '16px' }}>\r\n          <button \r\n            onClick={() => navigate('/warehouse/branches')}\r\n            style={{ \r\n              width: '40px', height: '40px', borderRadius: '12px', \r\n              background: '#FFF', border: '1px solid #E5E5EA',\r\n              display: 'flex', alignItems: 'center', justifyContent: 'center',\r\n              boxShadow: '0 2px 5px rgba(0,0,0,0.03)',\r\n              cursor: 'pointer',\r\n              padding: 0,\r\n              color: '#000'\r\n          }}\r\n        >\r\n          <ArrowLeft size={20} color=\"#000\" />\r\n        </button>\r\n          <div>\r\n            <h1 style={{ fontSize: '28px', fontWeight: '800', margin: '0', letterSpacing: '-0.5px' }}>\r\n              {branch.name}\r\n            </h1>\r\n            <div style={{ display: 'flex', alignItems: 'center', gap: '8px', marginTop: '4px' }}>\r\n              <span style={{ width: '8px', height: '8px', borderRadius: '50%', background: '#34C759' }}></span>\r\n              <span style={{ fontSize: '14px', color: '#666', fontWeight: 500 }}>Live Store Status</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        <div style={{ display: 'flex', gap: '12px' }}>\r\n          <button className=\"btn\" style={{ background: '#F5F5F7', fontWeight: 600 }}>\r\n             Export Report\r\n          </button>\r\n        </div>\r\n      </motion.div>\r\n\r\n      {/* STATS ROW */}\r\n      <motion.div variants={itemVariants} style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(240px, 1fr))', gap: '24px', marginBottom: '32px' }}>\r\n        <StatCard title=\"Total Revenue\" value={`$${stats.revenue.toLocaleString()}`} trend=\"+0%\" icon={DollarSign} color=\"#34C759\" />\r\n        <StatCard title=\"Active Orders\" value={stats.orders} trend=\"+0%\" icon={ShoppingBag} color=\"#007AFF\" />\r\n        <StatCard title=\"Total Stock\" value={stats.stock} trend=\"Items\" icon={Package} color=\"#FF9500\" />\r\n        <StatCard title=\"Employees\" value={stats.employees} trend=\"Active\" icon={Users} color=\"#5856D6\" />\r\n      </motion.div>\r\n\r\n      {/* CHARTS SECTION */}\r\n      <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr', gap: '24px', marginBottom: '32px' }}>\r\n        \r\n        {/* Main Sales Chart */}\r\n        <motion.div variants={itemVariants} className=\"card\" style={{ padding: '24px', minHeight: '400px', display: 'flex', flexDirection: 'column' }}>\r\n          <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '24px' }}>\r\n            <h3 style={{ margin: 0, fontSize: '18px', fontWeight: 700 }}>Sales Analytics</h3>\r\n            <select style={{ border: 'none', background: '#F5F5F7', padding: '4px 12px', borderRadius: '20px', fontSize: '12px', fontWeight: 600, cursor: 'pointer' }}>\r\n              <option>This Week</option>\r\n              <option>This Month</option>\r\n            </select>\r\n          </div>\r\n          <div style={{ flex: 1, width: '100%', minHeight: '300px' }}>\r\n            <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n              <AreaChart data={chartData}>\r\n                <defs>\r\n                  <linearGradient id=\"colorSales\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\r\n                    <stop offset=\"5%\" stopColor=\"#007AFF\" stopOpacity={0.3}/>\r\n                    <stop offset=\"95%\" stopColor=\"#007AFF\" stopOpacity={0}/>\r\n                  </linearGradient>\r\n                </defs>\r\n                <CartesianGrid strokeDasharray=\"3 3\" vertical={false} stroke=\"#E5E5EA\" />\r\n                <XAxis dataKey=\"name\" axisLine={false} tickLine={false} tick={{fill: '#999', fontSize: 12}} dy={10} />\r\n                <YAxis axisLine={false} tickLine={false} tick={{fill: '#999', fontSize: 12}} />\r\n                <Tooltip \r\n                  contentStyle={{ borderRadius: '12px', border: 'none', boxShadow: '0 4px 20px rgba(0,0,0,0.1)' }}\r\n                  cursor={{ stroke: '#007AFF', strokeWidth: 2 }}\r\n                />\r\n                <Area type=\"monotone\" dataKey=\"sales\" stroke=\"#007AFF\" strokeWidth={3} fillOpacity={1} fill=\"url(#colorSales)\" />\r\n              </AreaChart>\r\n            </ResponsiveContainer>\r\n          </div>\r\n        </motion.div>\r\n\r\n        {/* Category Pie Chart */}\r\n        <motion.div variants={itemVariants} className=\"card\" style={{ padding: '24px', minHeight: '400px', display: 'flex', flexDirection: 'column' }}>\r\n          <h3 style={{ margin: '0 0 24px', fontSize: '18px', fontWeight: 700 }}>Category Split</h3>\r\n          <div style={{ flex: 1, position: 'relative' }}>\r\n            {categoryData.length > 0 ? (\r\n                <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n                <PieChart>\r\n                    <Pie\r\n                    data={categoryData}\r\n                    innerRadius={60}\r\n                    outerRadius={80}\r\n                    paddingAngle={5}\r\n                    dataKey=\"value\"\r\n                    >\r\n                    {categoryData.map((entry, index) => (\r\n                        <Cell key={`cell-${index}`} fill={entry.color} />\r\n                    ))}\r\n                    </Pie>\r\n                    <Tooltip />\r\n                    <Legend verticalAlign=\"bottom\" height={36} iconType=\"circle\" />\r\n                </PieChart>\r\n                </ResponsiveContainer>\r\n            ) : (\r\n                <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', height: '100%', color: '#CCC' }}>\r\n                    No items in inventory\r\n                </div>\r\n            )}\r\n            \r\n            {/* Center Text Overlay */}\r\n            <div style={{ \r\n              position: 'absolute', top: '50%', left: '50%', transform: 'translate(-50%, -65%)', \r\n              textAlign: 'center' \r\n            }}>\r\n              <div style={{ fontSize: '24px', fontWeight: 'bold' }}>{stats.stock}</div>\r\n              <div style={{ fontSize: '12px', color: '#999' }}>Items</div>\r\n            </div>\r\n          </div>\r\n        </motion.div>\r\n      </div>\r\n\r\n      {/* QUICK ACTIONS GRID */}\r\n      <h3 style={{ fontSize: '20px', fontWeight: 'bold', marginBottom: '20px' }}>Management Hub</h3>\r\n      <motion.div variants={itemVariants} style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '20px' }}>\r\n        \r\n        {/* Inventory - Available to Inventory or Admin */}\r\n        {(isAdmin || hasPermission('INVENTORY_WRITE')) && (\r\n            <ActionTile \r\n            title=\"Stock Inventory\" \r\n            subtitle=\"Manage Items\" \r\n            icon={Package} \r\n            color=\"#000\" \r\n            dark \r\n            onClick={() => navigate(`/warehouse/branches/${branchId}/inventory`)} \r\n            />\r\n        )}\r\n        \r\n        {/* Transactions - Available to Reports or Admin */}\r\n        {(isAdmin || hasPermission('REPORTS_VIEW')) && (\r\n            <>\r\n                <ActionTile \r\n                title=\"View Transactions\" \r\n                subtitle=\"Sales Logs\" \r\n                icon={Activity} \r\n                color=\"#007AFF\" \r\n                onClick={() => navigate(`/warehouse/branches/${branchId}/actions`)} \r\n                />\r\n\r\n                <ActionTile \r\n                title=\"Sales History\" \r\n                subtitle=\"View Transactions\" \r\n                icon={TrendingUp} \r\n                color=\"#34C759\" \r\n                onClick={() => navigate(`/warehouse/branches/${branchId}/sales?tab=sales`)} \r\n                />\r\n\r\n                <ActionTile \r\n                title=\"Expenses\" \r\n                subtitle=\"Bills & Costs\" \r\n                icon={Activity} \r\n                color=\"#FF3B30\" \r\n                onClick={() => navigate(`/warehouse/branches/${branchId}/sales?tab=expenses`)} \r\n                />\r\n\r\n                <ActionTile \r\n                title=\"Monthly Receipts\" \r\n                subtitle=\"Sales Reports\" \r\n                icon={Calendar} \r\n                color=\"#5856D6\" \r\n                onClick={() => navigate(`/warehouse/branches/${branchId}/monthly-receipts`)} \r\n                />\r\n            </>\r\n        )}\r\n\r\n        {/* Payment Methods - Admin Only (Configuration) */}\r\n        {isAdmin && (\r\n            <ActionTile \r\n            title=\"Payment Methods\" \r\n            subtitle=\"Cash, Visa, etc.\" \r\n            icon={CreditCard} \r\n            color=\"#FF9500\" \r\n            onClick={() => navigate(`/warehouse/branches/${branchId}/payments`)} \r\n            />\r\n        )}\r\n\r\n        {/* Categories - Inventory Write or Admin */}\r\n        {(isAdmin || hasPermission('INVENTORY_WRITE')) && (\r\n            <ActionTile \r\n            title=\"Categories\" \r\n            subtitle=\"Manage Tags\" \r\n            icon={Package} \r\n            color=\"#FF9500\" \r\n            onClick={() => navigate(`/warehouse/branches/${branchId}/categories`)} \r\n            />\r\n        )}\r\n\r\n        {/* Employees - Admin Only */}\r\n        {isAdmin && (\r\n            <ActionTile \r\n            title=\"Staff Access\" \r\n            subtitle=\"Employees\" \r\n            icon={Users} \r\n            color=\"#5856D6\" \r\n            onClick={() => navigate(`/warehouse/branches/${branchId}/employees`)} \r\n            />\r\n        )}\r\n\r\n      </motion.div>\r\n\r\n    </motion.div>\r\n  );\r\n};\r\n\r\n// --- SUB COMPONENTS ---\r\n\r\nconst StatCard = ({ title, value, trend, icon: Icon, color }) => (\r\n  <motion.div \r\n    whileHover={{ y: -5 }}\r\n    className=\"card\" \r\n    style={{ padding: '24px', display: 'flex', flexDirection: 'column', justifyContent: 'space-between', borderTop: `4px solid ${color}` }}\r\n  >\r\n    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'start', marginBottom: '16px' }}>\r\n      <div style={{ padding: '10px', background: `${color}15`, borderRadius: '12px', color: color }}>\r\n        <Icon size={24} />\r\n      </div>\r\n      <span style={{ \r\n        fontSize: '12px', fontWeight: 600, \r\n        padding: '4px 8px', borderRadius: '20px', \r\n        background: trend.includes('+') ? '#E5F9E5' : '#F5F5F7',\r\n        color: trend.includes('+') ? '#007000' : '#666'\r\n      }}>\r\n        {trend}\r\n      </span>\r\n    </div>\r\n    <div>\r\n      <div style={{ fontSize: '14px', color: '#888', fontWeight: 500, marginBottom: '4px' }}>{title}</div>\r\n      <div style={{ fontSize: '28px', fontWeight: 'bold' }}>{value}</div>\r\n    </div>\r\n  </motion.div>\r\n);\r\n\r\nconst ActionTile = ({ title, subtitle, icon: Icon, color, dark, onClick }) => (\r\n  <motion.button \r\n    whileHover={{ scale: 1.02 }}\r\n    whileTap={{ scale: 0.98 }}\r\n    onClick={onClick}\r\n    style={{ \r\n      border: 'none',\r\n      background: dark ? '#1C1C1E' : '#FFF', \r\n      color: dark ? '#FFF' : '#000',\r\n      padding: '24px', \r\n      borderRadius: '16px', \r\n      textAlign: 'left', \r\n      cursor: 'pointer',\r\n      boxShadow: '0 4px 20px rgba(0,0,0,0.05)',\r\n      display: 'flex', flexDirection: 'column', height: '100%',\r\n      justifyContent: 'space-between'\r\n    }}\r\n  >\r\n    <div style={{ \r\n      alignSelf: 'flex-start', \r\n      padding: '12px', \r\n      background: dark ? 'rgba(255,255,255,0.1)' : `${color}15`, \r\n      borderRadius: '12px', \r\n      color: dark ? '#FFF' : color,\r\n      marginBottom: '24px'\r\n    }}>\r\n      <Icon size={24} />\r\n    </div>\r\n    <div>\r\n      <div style={{ fontSize: '16px', fontWeight: 'bold', marginBottom: '4px' }}>{title}</div>\r\n      <div style={{ fontSize: '13px', opacity: 0.7 }}>{subtitle}</div>\r\n    </div>\r\n  </motion.button>\r\n);\r\n\r\nexport default BranchDetailView;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\NIPEAL\\Desktop\\ClothingStore\\my-react-app\\src\\features\\warehouse\\branches\\BranchEmployeesView.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\NIPEAL\\Desktop\\ClothingStore\\my-react-app\\src\\features\\warehouse\\branches\\BranchSubViews.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[243,282],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'user' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":149,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":149,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"user"},"fix":{"range":[5663,5668],"text":""},"desc":"Remove unused variable 'user'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { ArrowLeft, Plus, DollarSign, FileText, Trash2, Calendar, TrendingDown, Wallet, Printer } from 'lucide-react';\r\nimport { useNavigate, useParams, useSearchParams } from 'react-router-dom';\r\nimport { useState, useEffect } from 'react';\r\nimport { motion } from 'framer-motion';\r\nimport { salesService } from '../../shop/services/salesService';\r\nimport { useAuth } from '../../auth/AuthContext';\r\n\r\nconst SimpleBackLayout = ({ title, children, onBack }) => (\r\n  <motion.div \r\n    initial={{ opacity: 0, y: 10 }}\r\n    animate={{ opacity: 1, y: 0 }}\r\n    transition={{ duration: 0.3 }}\r\n    style={{ maxWidth: '1000px', margin: '0 auto', paddingBottom: '40px' }}\r\n  >\r\n    <div style={{ display: 'flex', alignItems: 'center', gap: '16px', marginBottom: '32px' }}>\r\n      <button \r\n        onClick={onBack}\r\n        style={{ \r\n          width: '40px', height: '40px', borderRadius: '12px', \r\n          background: '#FFF', border: '1px solid #E5E5EA',\r\n          display: 'flex', alignItems: 'center', justifyContent: 'center',\r\n          boxShadow: '0 2px 5px rgba(0,0,0,0.03)',\r\n          cursor: 'pointer',\r\n          padding: 0,\r\n          color: '#000'\r\n        }}\r\n      >\r\n        <ArrowLeft size={20} color=\"#000\" />\r\n      </button>\r\n      <h1 style={{ fontSize: '28px', fontWeight: '800', margin: '0', letterSpacing: '-0.5px' }}>{title}</h1>\r\n    </div>\r\n    {children}\r\n  </motion.div>\r\n);\r\n\r\nexport const BranchSalesReportsView = () => {\r\n  const [searchParams] = useSearchParams();\r\n  const navigate = useNavigate();\r\n  const { branchId } = useParams();\r\n  \r\n  const initialTab = searchParams.get('tab') || 'expenses';\r\n  const [activeTab, setActiveTab] = useState(initialTab);\r\n\r\n  // --- EXPENSE STATE ---\r\n  const [expenseTypes, setExpenseTypes] = useState([\r\n    { id: 1, name: 'Electricity' },\r\n    { id: 2, name: 'Internet' },\r\n    { id: 3, name: 'Maintenance' },\r\n    { id: 4, name: 'Salaries' },\r\n    { id: 5, name: 'Rent' }\r\n  ]);\r\n  const [selectedType, setSelectedType] = useState(null); \r\n  const [expenses, setExpenses] = useState([\r\n    { id: 101, categoryId: 1, note: 'Oct Bill', amount: 150, date: '2023-10-25' },\r\n    { id: 102, categoryId: 3, note: 'AC Repair', amount: 50, date: '2023-10-24' },\r\n  ]);\r\n  const [expenseForm, setExpenseForm] = useState({ note: '', amount: '', date: new Date().toISOString().split('T')[0] });\r\n  const [newTypeName, setNewTypeName] = useState('');\r\n  const [showAddType, setShowAddType] = useState(false);\r\n\r\n  // --- SALES STATE ---\r\n  // --- SALES STATE ---\r\n  const [sales, setSales] = useState([]);\r\n  const [currencyTotals, setCurrencyTotals] = useState({});\r\n\r\n  useEffect(() => {\r\n      const loadSales = async () => {\r\n      try {\r\n        if (activeTab === 'sales') {\r\n          // 1. Load Sales\r\n          const salesData = await salesService.getBranchSales(branchId);\r\n          \r\n          // 2. Load Staff Directory\r\n          let staffMap = {};\r\n          try {\r\n              const allStaff = await import('../../auth/services/authService').then(m => m.authService.getAllStaff());\r\n              allStaff.forEach(s => {\r\n                  staffMap[s.id] = s.name || s.username || 'Staff'; \r\n              });\r\n          } catch (e) { console.error(e); }\r\n\r\n          // 3. Map Sales\r\n          const formattedSales = salesData.map(sale => {\r\n             const resolvedName = sale.adminName || staffMap[sale.adminId] || sale.adminId || 'Staff';\r\n             \r\n             return {\r\n                 id: sale.id,\r\n                 rawDate: sale.createdAt?.toDate ? sale.createdAt.toDate().toISOString().split('T')[0] : (sale.date || ''),\r\n                 dateDisplay: sale.date + ' ' + (sale.createdAt?.toDate ? sale.createdAt.toDate().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}) : ''),\r\n                 items: sale.items ? sale.items.map(i => i.name) : ['Unknown Item'],\r\n                 count: sale.items ? sale.items.reduce((acc, i) => acc + (i.qty || 1), 0) : 0,\r\n                 total: Number(sale.total) || 0,\r\n                 currency: sale.currency || 'USD',\r\n                 status: sale.status || 'COMPLETED',\r\n                 user: resolvedName\r\n             };\r\n          });\r\n          setSales(formattedSales);\r\n\r\n          // Calculate Currency Totals\r\n          const totals = formattedSales.reduce((acc, sale) => {\r\n              const curr = sale.currency || 'USD';\r\n              acc[curr] = (acc[curr] || 0) + sale.total;\r\n              return acc;\r\n          }, {});\r\n          setCurrencyTotals(totals);\r\n        }\r\n      } catch (err) {\r\n        console.error(\"Failed to load sales log\", err);\r\n      }\r\n    };\r\n    loadSales();\r\n  }, [branchId, activeTab]);\r\n\r\n  // Sync tab with URL\r\n  useEffect(() => {\r\n    setActiveTab(searchParams.get('tab') || 'expenses');\r\n  }, [searchParams]);\r\n\r\n  const handleAddType = (e) => {\r\n    e.preventDefault();\r\n    if (!newTypeName) return;\r\n    setExpenseTypes([...expenseTypes, { id: Date.now(), name: newTypeName }]);\r\n    setNewTypeName('');\r\n    setShowAddType(false);\r\n  };\r\n\r\n  const handleRecordExpense = (e) => {\r\n    e.preventDefault();\r\n    if (!selectedType || !expenseForm.amount) return;\r\n    setExpenses([\r\n      { \r\n        id: Date.now(), \r\n        categoryId: selectedType.id,\r\n        note: expenseForm.note, \r\n        amount: Number(expenseForm.amount), \r\n        date: expenseForm.date \r\n      },\r\n      ...expenses\r\n    ]);\r\n    setExpenseForm({ note: '', amount: '', date: new Date().toISOString().split('T')[0] });\r\n  };\r\n\r\n  const filteredExpenses = selectedType \r\n    ? expenses.filter(e => e.categoryId === selectedType.id)\r\n    : [];\r\n\r\n  // Permissions Check\r\n  const { user, hasPermission } = useAuth();\r\n  const canViewReports = hasPermission('REPORTS_VIEW');\r\n\r\n  if (!canViewReports) {\r\n      return (\r\n        <SimpleBackLayout title=\"Restricted Access\" onBack={() => navigate(`/warehouse/branches/${branchId}`)}>\r\n            <div className=\"card\" style={{ padding: '60px', textAlign: 'center', color: '#666' }}>\r\n                <div style={{ fontSize: '48px', marginBottom: '16px' }}>≡ƒöÆ</div>\r\n                <h3>Access Denied</h3>\r\n                <p>You do not have permission to view financial records and sales logs.</p>\r\n            </div>\r\n        </SimpleBackLayout>\r\n      );\r\n  }\r\n\r\n  return (\r\n    <SimpleBackLayout title={activeTab === 'expenses' ? \"Branch Expenses\" : \"Sales Records\"} onBack={() => navigate(`/warehouse/branches/${branchId}`)}>\r\n      \r\n      {/* Custom Tab Switcher */}\r\n      <div style={{ background: '#F1F1F4', padding: '4px', borderRadius: '14px', display: 'inline-flex', marginBottom: '32px' }}>\r\n        <button \r\n          onClick={() => setActiveTab('sales')}\r\n          style={{ \r\n            padding: '10px 24px', borderRadius: '12px', border: 'none', fontWeight: 600, fontSize: '14px', cursor: 'pointer',\r\n            background: activeTab === 'sales' ? '#FFF' : 'transparent',\r\n            boxShadow: activeTab === 'sales' ? '0 2px 8px rgba(0,0,0,0.08)' : 'none',\r\n            color: activeTab === 'sales' ? '#000' : '#888'\r\n          }}\r\n        >\r\n          Sales History\r\n        </button>\r\n        <button \r\n          onClick={() => setActiveTab('expenses')}\r\n          style={{ \r\n            padding: '10px 24px', borderRadius: '12px', border: 'none', fontWeight: 600, fontSize: '14px', cursor: 'pointer',\r\n            background: activeTab === 'expenses' ? '#FFF' : 'transparent',\r\n            boxShadow: activeTab === 'expenses' ? '0 2px 8px rgba(0,0,0,0.08)' : 'none',\r\n            color: activeTab === 'expenses' ? '#000' : '#888'\r\n          }}\r\n        >\r\n          Expenses\r\n        </button>\r\n      </div>\r\n\r\n      {activeTab === 'expenses' ? (\r\n        <div style={{ display: 'grid', gridTemplateColumns: 'minmax(280px, 1fr) 2fr', gap: '24px' }}>\r\n          \r\n          {/* LEFT: Categories Grid */}\r\n          <div style={{ display: 'flex', flexDirection: 'column', gap: '24px' }}>\r\n            <motion.div \r\n               initial={{ opacity: 0 }} animate={{ opacity: 1 }}\r\n               className=\"card\" style={{ padding: '24px' }}\r\n            >\r\n              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '20px' }}>\r\n                <h3 style={{ margin: 0, fontSize: '16px', fontWeight: 700 }}>Expense Types</h3>\r\n                <button \r\n                  className=\"btn\" \r\n                  style={{ width: '28px', height: '28px', borderRadius: '8px', background: '#F5F5F7', display: 'flex', alignItems: 'center', justifyContent: 'center' }} \r\n                  onClick={() => setShowAddType(!showAddType)}\r\n                >\r\n                  <Plus size={16}/>\r\n                </button>\r\n              </div>\r\n\r\n              {showAddType && (\r\n                <form onSubmit={handleAddType} style={{ marginBottom: '16px', display: 'flex', gap: '8px' }}>\r\n                  <input \r\n                    className=\"input-field\" \r\n                    placeholder=\"New Category...\" \r\n                    value={newTypeName}\r\n                    onChange={e => setNewTypeName(e.target.value)}\r\n                    autoFocus\r\n                    style={{ fontSize: '13px' }}\r\n                  />\r\n                  <button type=\"submit\" className=\"btn btn-primary\" style={{ padding: '8px 12px' }}>Add</button>\r\n                </form>\r\n              )}\r\n\r\n              <div style={{ display: 'grid', gap: '10px' }}>\r\n                {expenseTypes.map(type => (\r\n                  <button \r\n                    key={type.id} \r\n                    onClick={() => setSelectedType(type)}\r\n                    style={{ \r\n                      display: 'flex', justifyContent: 'space-between', alignItems: 'center', \r\n                      padding: '16px', \r\n                      background: selectedType?.id === type.id ? '#1C1C1E' : '#FFF',\r\n                      color: selectedType?.id === type.id ? '#FFF' : '#333',\r\n                      border: '1px solid',\r\n                      borderColor: selectedType?.id === type.id ? '#1C1C1E' : '#E5E5EA',\r\n                      borderRadius: '12px',\r\n                      cursor: 'pointer',\r\n                      textAlign: 'left',\r\n                      transition: 'all 0.2s',\r\n                    }}\r\n                  >\r\n                    <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>\r\n                       <div style={{ \r\n                         padding: '8px', borderRadius: '8px', \r\n                         background: selectedType?.id === type.id ? 'rgba(255,255,255,0.2)' : '#F5F5F7' \r\n                       }}>\r\n                         <Wallet size={16} />\r\n                       </div>\r\n                       <span style={{ fontWeight: 600, fontSize: '14px' }}>{type.name}</span>\r\n                    </div>\r\n                  </button>\r\n                ))}\r\n              </div>\r\n            </motion.div>\r\n          </div>\r\n\r\n          {/* RIGHT: Detail Drill-down */}\r\n          <div>\r\n            {!selectedType ? (\r\n              <motion.div \r\n                initial={{ opacity: 0 }} animate={{ opacity: 1 }}\r\n                className=\"card\" \r\n                style={{ padding: '60px', textAlign: 'center', color: '#888', background: '#F9F9FB', borderStyle: 'dashed' }}\r\n              >\r\n                <FileText size={48} style={{ opacity: 0.1, marginBottom: '16px' }} />\r\n                <h3 style={{ margin: '0 0 8px', color: '#000' }}>Select a Category</h3>\r\n                <p style={{ margin: 0, fontSize: '14px' }}>Choose an expense type from the left to view records.</p>\r\n              </motion.div>\r\n            ) : (\r\n              <motion.div \r\n                key={selectedType.id}\r\n                initial={{ opacity: 0, x: 20 }} animate={{ opacity: 1, x: 0 }}\r\n                className=\"card\"\r\n                style={{ padding: '0', overflow: 'hidden' }}\r\n              >\r\n                {/* Header */}\r\n                <div style={{ padding: '24px', borderBottom: '1px solid #F0F0F0', display: 'flex', justifyContent: 'space-between', alignItems: 'center', background: '#FFF' }}>\r\n                  <div>\r\n                    <h3 style={{ margin: '0 0 4px', fontSize: '20px', fontWeight: 700 }}>{selectedType.name}</h3>\r\n                    <div style={{ fontSize: '13px', color: '#888' }}>Expense Log</div>\r\n                  </div>\r\n                  <div style={{ textAlign: 'right' }}>\r\n                    <div style={{ fontSize: '12px', color: '#888', fontWeight: 600 }}>TOTAL SPENT</div>\r\n                    <div style={{ fontSize: '24px', fontWeight: 'bold', color: '#FF3B30' }}>\r\n                      ${filteredExpenses.reduce((sum, e) => sum + e.amount, 0).toLocaleString()}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Add Form */}\r\n                <div style={{ padding: '24px', background: '#FAFAFA', borderBottom: '1px solid #F0F0F0' }}>\r\n                  <form onSubmit={handleRecordExpense}>\r\n                    <div style={{ display: 'flex', alignItems: 'flex-end', gap: '12px' }}>\r\n                      <div style={{ flex: 2 }}>\r\n                        <label style={{ fontSize: '12px', fontWeight: 600, marginLeft: '4px', marginBottom: '6px', display: 'block', color: '#666' }}>NOTE</label>\r\n                        <input \r\n                          className=\"input-field\" \r\n                          placeholder=\"e.g. Monthly Bill\" \r\n                          value={expenseForm.note}\r\n                          onChange={e => setExpenseForm({...expenseForm, note: e.target.value})}\r\n                          required\r\n                          style={{ background: '#FFF' }}\r\n                        />\r\n                      </div>\r\n                      <div style={{ flex: 1 }}>\r\n                        <label style={{ fontSize: '12px', fontWeight: 600, marginLeft: '4px', marginBottom: '6px', display: 'block', color: '#666' }}>AMOUNT</label>\r\n                        <input \r\n                          type=\"number\" \r\n                          className=\"input-field\" \r\n                          placeholder=\"0.00\" \r\n                          value={expenseForm.amount}\r\n                          onChange={e => setExpenseForm({...expenseForm, amount: e.target.value})}\r\n                          required\r\n                          style={{ background: '#FFF' }}\r\n                        />\r\n                      </div>\r\n                      <div style={{ flex: 1 }}>\r\n                         <label style={{ fontSize: '12px', fontWeight: 600, marginLeft: '4px', marginBottom: '6px', display: 'block', color: '#666' }}>DATE</label>\r\n                         <input \r\n                           type=\"date\" \r\n                           className=\"input-field\" \r\n                           value={expenseForm.date}\r\n                           onChange={e => setExpenseForm({...expenseForm, date: e.target.value})}\r\n                           required\r\n                           style={{ background: '#FFF' }}\r\n                         />\r\n                      </div>\r\n                      <button type=\"submit\" className=\"btn btn-primary\" style={{ height: '42px', padding: '0 24px', background: '#FF3B30', borderColor: '#FF3B30' }}>\r\n                        Add\r\n                      </button>\r\n                    </div>\r\n                  </form>\r\n                </div>\r\n\r\n                {/* List */}\r\n                <div style={{ maxHeight: '400px', overflowY: 'auto' }}>\r\n                  {filteredExpenses.length === 0 ? (\r\n                    <div style={{ padding: '40px', textAlign: 'center', color: '#999', fontSize: '14px' }}>\r\n                      No expenses recorded for {selectedType.name} yet.\r\n                    </div>\r\n                  ) : (\r\n                    <table style={{ width: '100%', borderCollapse: 'collapse' }}>\r\n                      <thead style={{ position: 'sticky', top: 0, background: '#FFF' }}>\r\n                        <tr style={{ textAlign: 'left', color: '#888', fontSize: '12px', borderBottom: '1px solid #eee' }}>\r\n                          <th style={{ padding: '16px 24px' }}>DATE</th>\r\n                          <th style={{ padding: '16px' }}>DESCRIPTION</th>\r\n                          <th style={{ padding: '16px', textAlign: 'right' }}>AMOUNT</th>\r\n                          <th style={{ padding: '16px 24px' }}></th>\r\n                        </tr>\r\n                      </thead>\r\n                      <tbody>\r\n                        {filteredExpenses.map(item => (\r\n                          <tr key={item.id} style={{ borderBottom: '1px solid #F9F9F9' }}>\r\n                            <td style={{ padding: '16px 24px', fontSize: '14px', color: '#666' }}>{item.date}</td>\r\n                            <td style={{ padding: '16px', fontWeight: 500 }}>{item.note}</td>\r\n                            <td style={{ padding: '16px', textAlign: 'right', fontWeight: 'bold' }}>${item.amount}</td>\r\n                            <td style={{ padding: '16px 24px', textAlign: 'right' }}>\r\n                              <button className=\"btn\" style={{ padding: '6px', color: '#E5E5EA', hover: { color: '#D00' } }}><Trash2 size={16}/></button>\r\n                            </td>\r\n                          </tr>\r\n                        ))}\r\n                      </tbody>\r\n                    </table>\r\n                  )}\r\n                </div>\r\n              </motion.div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      ) : (\r\n        /* SALES TAB - ISOLATED */\r\n        <SalesTabContent sales={sales} currencyTotals={currencyTotals} />\r\n      )}\r\n    </SimpleBackLayout>\r\n  );\r\n};\r\n\r\nconst SalesTabContent = ({ sales, currencyTotals }) => {\r\n  const [filters, setFilters] = useState({\r\n    startDate: '',\r\n    endDate: '',\r\n    employee: '',\r\n    minPrice: '',\r\n    maxPrice: ''\r\n  });\r\n\r\n  const uniqueEmployees = [...new Set(sales.map(s => s.user))].filter(Boolean);\r\n\r\n  const filteredSales = sales.filter(sale => {\r\n    // 1. Date Filter\r\n    if (filters.startDate && sale.rawDate < filters.startDate) return false;\r\n    if (filters.endDate && sale.rawDate > filters.endDate) return false;\r\n    \r\n    // 2. Employee Filter\r\n    if (filters.employee && !sale.user.toLowerCase().includes(filters.employee.toLowerCase())) return false;\r\n\r\n    // 3. Price Filter\r\n    if (filters.minPrice && sale.total < Number(filters.minPrice)) return false;\r\n    if (filters.maxPrice && sale.total > Number(filters.maxPrice)) return false;\r\n\r\n    return true;\r\n  });\r\n\r\n  return (\r\n    <>\r\n      {/* Print Styles */}\r\n      <style>\r\n        {`\r\n          @media print {\r\n            body * { visibility: hidden; }\r\n            #sales-print-area, #sales-print-area * { visibility: visible; }\r\n            #sales-print-area {\r\n              position: absolute;\r\n              left: 0;\r\n              top: 0;\r\n              width: 100%;\r\n              background: white;\r\n              color: black;\r\n              padding: 20px;\r\n            }\r\n            .no-print { display: none !important; }\r\n            @page { margin: 10mm; }\r\n          }\r\n        `}\r\n      </style>\r\n    <motion.div id=\"sales-print-area\" initial={{ opacity: 0 }} animate={{ opacity: 1 }} className=\"card\" style={{ padding: '0', overflow: 'hidden' }}>\r\n      <div style={{ padding: '24px', borderBottom: '1px solid #F0F0F0', display: 'flex', flexDirection: 'column', gap: '20px' }}>\r\n        \r\n        {/* Header Row */}\r\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n          <h3 style={{ margin: 0, fontSize: '18px', fontWeight: 700 }}>Complete Sales Log</h3>\r\n          \r\n          <div style={{ display: 'flex', gap: '16px' }}>\r\n            {Object.entries(currencyTotals).map(([curr, amount]) => (\r\n                <div key={curr} style={{ padding: '8px 16px', background: '#F5F5F7', borderRadius: '8px', fontSize: '13px' }}>\r\n                  <span style={{ fontWeight: 600, color: '#666', marginRight: '6px' }}>Total {curr}:</span>\r\n                  <span style={{ fontWeight: 700, color: '#000' }}>\r\n                      {curr === 'USD' ? '$' : ''}{amount.toLocaleString()} {curr !== 'USD' ? curr : ''}\r\n                  </span>\r\n                </div>\r\n            ))}\r\n               <button \r\n                 onClick={() => window.print()}\r\n                 className=\"btn\" \r\n                 style={{ background: '#007AFF', color: '#FFF', fontSize: '12px', fontWeight: 600, display: 'flex', alignItems: 'center', gap: '6px' }}\r\n               >\r\n                 <Printer size={14} /> Print Report\r\n               </button>\r\n               <button className=\"btn\" style={{ background: '#F5F5F7', color: '#000', fontSize: '12px', fontWeight: 600 }}>Export CSV</button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Filter Row */}\r\n        <div style={{ display: 'flex', gap: '12px', flexWrap: 'wrap', padding: '16px', background: '#FAFAFA', borderRadius: '12px' }}>\r\n            <div style={{ display: 'flex', flexDirection: 'column', gap: '4px' }}>\r\n                <label style={{ fontSize: '11px', fontWeight: 600, color: '#666' }}>DATE RANGE</label>\r\n                <div style={{ display: 'flex', gap: '8px' }}>\r\n                    <input type=\"date\" className=\"input-field\" style={{ padding: '8px', fontSize: '12px', width: '130px', background: '#FFF' }} \r\n                        value={filters.startDate} onChange={e => setFilters({...filters, startDate: e.target.value})} />\r\n                    <input type=\"date\" className=\"input-field\" style={{ padding: '8px', fontSize: '12px', width: '130px', background: '#FFF' }} \r\n                        value={filters.endDate} onChange={e => setFilters({...filters, endDate: e.target.value})} />\r\n                </div>\r\n            </div>\r\n            \r\n            <div style={{ display: 'flex', flexDirection: 'column', gap: '4px' }}>\r\n                <label style={{ fontSize: '11px', fontWeight: 600, color: '#666' }}>EMPLOYEE</label>\r\n                <select className=\"input-field\" style={{ padding: '8px', fontSize: '12px', width: '150px', background: '#FFF' }}\r\n                    value={filters.employee} onChange={e => setFilters({...filters, employee: e.target.value})}>\r\n                    <option value=\"\">All Employees</option>\r\n                    {uniqueEmployees.map(emp => <option key={emp} value={emp}>{emp}</option>)}\r\n                </select>\r\n            </div>\r\n\r\n            <div style={{ display: 'flex', flexDirection: 'column', gap: '4px' }}>\r\n                <label style={{ fontSize: '11px', fontWeight: 600, color: '#666' }}>PRICE RANGE</label>\r\n                <div style={{ display: 'flex', gap: '8px' }}>\r\n                    <input type=\"number\" placeholder=\"Min\" className=\"input-field\" style={{ padding: '8px', fontSize: '12px', width: '80px', background: '#FFF' }}\r\n                        value={filters.minPrice} onChange={e => setFilters({...filters, minPrice: e.target.value})} />\r\n                    <input type=\"number\" placeholder=\"Max\" className=\"input-field\" style={{ padding: '8px', fontSize: '12px', width: '80px', background: '#FFF' }}\r\n                        value={filters.maxPrice} onChange={e => setFilters({...filters, maxPrice: e.target.value})} />\r\n                </div>\r\n            </div>\r\n             <button \r\n                onClick={() => setFilters({ startDate: '', endDate: '', employee: '', minPrice: '', maxPrice: '' })}\r\n                style={{ alignSelf: 'flex-end', padding: '8px 16px', fontSize: '12px', background: 'transparent', border: 'none', color: '#007AFF', cursor: 'pointer', height: '36px' }}\r\n             >\r\n                 Clear\r\n             </button>\r\n        </div>\r\n\r\n      </div>\r\n\r\n      <table style={{ width: '100%', borderCollapse: 'collapse' }}>\r\n        <thead>\r\n          <tr style={{ textAlign: 'left', background: '#FAFAFA', fontSize: '12px', color: '#666', fontWeight: 600, textTransform: 'uppercase' }}>\r\n            <th style={{ padding: '16px 24px' }}>Date</th>\r\n            <th style={{ padding: '16px' }}>Status</th>\r\n            <th style={{ padding: '16px' }}>Items Sold</th>\r\n            <th style={{ padding: '16px' }}>Staff</th>\r\n            <th style={{ padding: '16px' }}>Count</th>\r\n            <th style={{ padding: '16px 24px', textAlign: 'right' }}>Total</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {filteredSales.length === 0 ? (\r\n              <tr><td colSpan=\"6\" style={{ padding: '40px', textAlign: 'center', color: '#999' }}>No records found matching filters.</td></tr>\r\n          ) : (\r\n            filteredSales.map(sale => (\r\n                <tr key={sale.id} style={{ borderBottom: '1px solid #F5F5F7' }}>\r\n                <td style={{ padding: '20px 24px', color: '#555', fontSize: '14px' }}>{sale.dateDisplay}</td>\r\n                <td style={{ padding: '20px 16px' }}>\r\n                     <span style={{ \r\n                         padding: '4px 10px', borderRadius: '12px', fontSize: '11px', fontWeight: 700,\r\n                         background: sale.status === 'ORDER' ? '#FFF4E5' : '#E5F9E5',\r\n                         color: sale.status === 'ORDER' ? '#FF9500' : '#34C759',\r\n                         border: `1px solid ${sale.status === 'ORDER' ? '#FFD8A8' : '#C3F3C3'}`\r\n                     }}>\r\n                         {sale.status === 'ORDER' ? 'ORDER' : 'SALE'}\r\n                     </span>\r\n                </td>\r\n                <td style={{ padding: '20px 16px' }}>\r\n                    <div style={{ fontWeight: 600 }}>{sale.items[0]}</div>\r\n                    {sale.items.length > 1 && <div style={{ fontSize: '12px', color: '#888' }}>+{sale.items.length - 1} more items</div>}\r\n                </td>\r\n                <td style={{ padding: '20px 16px', fontSize: '14px', color: '#666' }}>\r\n                    {sale.user}\r\n                </td>\r\n                <td style={{ padding: '20px 16px', fontSize: '14px' }}>{sale.items.length}</td>\r\n                <td style={{ padding: '20px 24px', textAlign: 'right', fontWeight: 'bold', color: '#000', fontSize: '16px' }}>\r\n                    {sale.currency === 'ID' || sale.currency === 'IQD' || sale.currency === 'Dinar' ? '' : '$'}{sale.total.toFixed(2)} {sale.currency}\r\n                </td>\r\n                </tr>\r\n            ))\r\n          )}\r\n        </tbody>\r\n      </table>\r\n    </motion.div>\r\n    </>\r\n  );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\NIPEAL\\Desktop\\ClothingStore\\my-react-app\\src\\features\\warehouse\\branches\\BranchesView.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":6,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[327,334],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n  24 |\n  25 |   useEffect(() => {\n> 26 |     fetchBranches();\n     |     ^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  27 |   }, []);\n  28 |\n  29 |   const handleAddBranch = async (e) => {","line":26,"column":5,"nodeType":null,"endLine":26,"endColumn":18}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { useAuth } from '../../auth/AuthContext';\r\nimport { Plus, MapPin, Users, DollarSign, Search, Filter, MoreHorizontal, ArrowRight, X } from 'lucide-react';\r\nimport { branchService } from '../services/branchService';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\nconst BranchesView = () => {\r\n  const navigate = useNavigate();\r\n  const { user } = useAuth();\r\n  const [branches, setBranches] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [showAddForm, setShowAddForm] = useState(false);\r\n\r\n  // Form State\r\n  const [newBranch, setNewBranch] = useState({ name: '', location: '', manager: '' });\r\n\r\n  const fetchBranches = async () => {\r\n    setLoading(true);\r\n    const data = await branchService.getBranches();\r\n    setBranches(data);\r\n    setLoading(false);\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchBranches();\r\n  }, []);\r\n\r\n  const handleAddBranch = async (e) => {\r\n    e.preventDefault();\r\n    await branchService.addBranch(newBranch);\r\n    setShowAddForm(false);\r\n    setNewBranch({ name: '', location: '', manager: '' });\r\n    fetchBranches();\r\n  };\r\n\r\n  if (loading) return <div style={{ padding: '40px', textAlign: 'center', color: '#888' }}>Loading Branches...</div>;\r\n\r\n  const containerVariants = {\r\n    hidden: { opacity: 0 },\r\n    visible: { opacity: 1, transition: { staggerChildren: 0.1 } }\r\n  };\r\n\r\n  const itemVariants = {\r\n    hidden: { y: 20, opacity: 0 },\r\n    visible: { y: 0, opacity: 1 }\r\n  };\r\n\r\n  return (\r\n    <motion.div \r\n      initial=\"hidden\"\r\n      animate=\"visible\"\r\n      variants={containerVariants}\r\n      style={{ maxWidth: '1200px', margin: '0 auto', paddingBottom: '40px' }}\r\n    >\r\n      {/* HEADER SECTION */}\r\n      <motion.div \r\n        variants={itemVariants}\r\n        style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'end', marginBottom: '40px' }}\r\n      >\r\n        <div>\r\n           <div style={{ fontSize: '13px', fontWeight: 600, color: '#888', textTransform: 'uppercase', letterSpacing: '1px', marginBottom: '8px' }}>\r\n            Store Locations\r\n          </div>\r\n          <h1 style={{ fontSize: '32px', fontWeight: '800', margin: '0', letterSpacing: '-0.5px' }}>\r\n            Branch Management\r\n          </h1>\r\n        </div>\r\n        \r\n        <div style={{ display: 'flex', gap: '12px' }}>\r\n          <div style={{ position: 'relative' }}>\r\n             <Search size={18} style={{ position: 'absolute', left: '12px', top: '11px', color: '#999' }} />\r\n             <input \r\n               className=\"input-field\" \r\n               placeholder=\"Search branches...\" \r\n               style={{ paddingLeft: '40px', width: '240px', background: '#FFF', borderColor: '#E5E5EA' }}\r\n             />\r\n          </div>\r\n          {/* Only Admins can add branches */}\r\n          {user && user.role === 'admin' && (\r\n            <button \r\n                className=\"btn btn-primary\" \r\n                style={{ boxShadow: '0 4px 12px rgba(0,0,0,0.1)' }}\r\n                onClick={() => setShowAddForm(true)}\r\n            >\r\n                <Plus size={20} style={{ marginRight: '8px' }} /> Add Branch\r\n            </button>\r\n          )}\r\n        </div>\r\n      </motion.div>\r\n\r\n      {/* ADD FORM OVERLAY */}\r\n      <AnimatePresence>\r\n        {showAddForm && (\r\n          <motion.div \r\n            initial={{ opacity: 0, height: 0, marginBottom: 0 }}\r\n            animate={{ opacity: 1, height: 'auto', marginBottom: 32 }}\r\n            exit={{ opacity: 0, height: 0, marginBottom: 0 }}\r\n            style={{ overflow: 'hidden' }}\r\n          >\r\n            <div className=\"card\" style={{ padding: '32px', background: '#FAFAFA', border: '1px solid #E5E5EA', position: 'relative' }}>\r\n               <button \r\n                 onClick={() => setShowAddForm(false)} \r\n                 style={{ position: 'absolute', top: '24px', right: '24px', background: 'transparent', border: 'none', cursor: 'pointer', color: '#999' }}\r\n               >\r\n                 <X size={20} />\r\n               </button>\r\n               <h3 style={{ margin: '0 0 24px 0', fontSize: '18px', fontWeight: 700 }}>Open New Location</h3>\r\n               \r\n               <form onSubmit={handleAddBranch} style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '24px', alignItems: 'end' }}>\r\n                 <div>\r\n                   <label style={{ display: 'block', marginBottom: '8px', fontSize: '12px', fontWeight: 600, color: '#666' }}>BRANCH NAME</label>\r\n                   <input className=\"input-field\" placeholder=\"e.g. North Side Store\" value={newBranch.name} onChange={e => setNewBranch({...newBranch, name: e.target.value})} required style={{ background: '#FFF' }} />\r\n                 </div>\r\n                 <div>\r\n                   <label style={{ display: 'block', marginBottom: '8px', fontSize: '12px', fontWeight: 600, color: '#666' }}>LOCATION</label>\r\n                   <input className=\"input-field\" placeholder=\"Street Address\" value={newBranch.location} onChange={e => setNewBranch({...newBranch, location: e.target.value})} required style={{ background: '#FFF' }} />\r\n                 </div>\r\n                 <div>\r\n                   <label style={{ display: 'block', marginBottom: '8px', fontSize: '12px', fontWeight: 600, color: '#666' }}>MANAGER</label>\r\n                   <input className=\"input-field\" placeholder=\"Full Name\" value={newBranch.manager} onChange={e => setNewBranch({...newBranch, manager: e.target.value})} required style={{ background: '#FFF' }} />\r\n                 </div>\r\n                 <button type=\"submit\" className=\"btn btn-primary\" style={{ height: '42px' }}>\r\n                   Confirm & Create\r\n                 </button>\r\n               </form>\r\n            </div>\r\n          </motion.div>\r\n        )}\r\n      </AnimatePresence>\r\n\r\n      {/* BRANCHES GRID */}\r\n      <div className=\"responsive-grid\" style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(340px, 1fr))', gap: '24px' }}>\r\n        {branches.map(branch => (\r\n          <BranchCard key={branch.id} branch={branch} onClick={() => navigate(`/warehouse/branches/${branch.id}`)} />\r\n        ))}\r\n      </div>\r\n    </motion.div>\r\n  );\r\n};\r\n\r\nconst BranchCard = ({ branch, onClick }) => {\r\n  return (\r\n    <motion.div \r\n      whileHover={{ y: -5, boxShadow: '0 12px 30px rgba(0,0,0,0.08)' }}\r\n      className=\"card\" \r\n      onClick={onClick}\r\n      style={{ \r\n        padding: '0', cursor: 'pointer', \r\n        border: '1px solid rgba(0,0,0,0.03)',\r\n        overflow: 'hidden',\r\n        display: 'flex', flexDirection: 'column'\r\n      }}\r\n    >\r\n      {/* Card Header with Status */}\r\n      <div style={{ padding: '24px', borderBottom: '1px solid #F5F5F7', display: 'flex', justifyContent: 'space-between', alignItems: 'start' }}>\r\n         <div>\r\n           <h3 style={{ margin: '0 0 6px', fontSize: '18px', fontWeight: 700 }}>{branch.name}</h3>\r\n           <div style={{ display: 'flex', alignItems: 'center', gap: '6px', color: '#666', fontSize: '13px' }}>\r\n              <MapPin size={14} /> {branch.location}\r\n           </div>\r\n         </div>\r\n         <span style={{ \r\n           fontSize: '11px', fontWeight: 700, padding: '4px 10px', borderRadius: '20px', letterSpacing: '0.5px',\r\n           background: '#E5F9E5', color: '#007000', textTransform: 'uppercase'\r\n         }}>\r\n           Active\r\n         </span>\r\n      </div>\r\n\r\n      {/* Card Body - Stats & Info */}\r\n      <div style={{ padding: '24px', flex: 1, display: 'flex', flexDirection: 'column', gap: '16px' }}>\r\n        \r\n        <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>\r\n          <div style={{ width: '36px', height: '36px', borderRadius: '50%', background: '#F0F0F5', display: 'flex', alignItems: 'center', justifyContent: 'center', color: '#666' }}>\r\n             <Users size={18} />\r\n          </div>\r\n          <div>\r\n            <div style={{ fontSize: '12px', color: '#888' }}>Staff & Mgmt</div>\r\n            <div style={{ fontSize: '14px', fontWeight: 600 }}>{branch.employees} Active ΓÇó {branch.manager.split(' ')[0]}</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>\r\n           <div style={{ width: '36px', height: '36px', borderRadius: '50%', background: '#F0F0F5', display: 'flex', alignItems: 'center', justifyContent: 'center', color: '#666' }}>\r\n             <DollarSign size={18} />\r\n          </div>\r\n          <div>\r\n             <div style={{ fontSize: '12px', color: '#888' }}>Current Revenue</div>\r\n             <div style={{ fontSize: '16px', fontWeight: 700, color: '#333' }}>${branch.revenue.toLocaleString()}</div>\r\n          </div>\r\n        </div>\r\n\r\n      </div>\r\n\r\n      {/* Card Footer - Action hint */}\r\n      <div style={{ padding: '16px 24px', background: '#FAFAFA', borderTop: '1px solid #F0F0F0', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n         <span style={{ fontSize: '12px', color: '#999', fontWeight: 500 }}>View Dashboard</span>\r\n         <ArrowRight size={16} color=\"#CCC\" />\r\n      </div>\r\n\r\n    </motion.div>\r\n  );\r\n};\r\n\r\nexport default BranchesView;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\NIPEAL\\Desktop\\ClothingStore\\my-react-app\\src\\features\\warehouse\\branches\\MonthlyReceiptsView.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'idx' is defined but never used.","line":214,"column":59,"nodeType":"Identifier","messageId":"unusedVar","endLine":214,"endColumn":62,"suggestions":[{"messageId":"removeVar","data":{"varName":"idx"},"fix":{"range":[10234,10239],"text":""},"desc":"Remove unused variable 'idx'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { ArrowLeft, Calendar, Printer, DollarSign, TrendingUp } from 'lucide-react';\r\nimport { useNavigate, useParams } from 'react-router-dom';\r\nimport { useState, useEffect, useRef } from 'react';\r\nimport { salesService } from '../../shop/services/salesService';\r\nimport { branchService } from '../services/branchService';\r\n\r\nconst MONTHS = [\r\n  'January', 'February', 'March', 'April', 'May', 'June',\r\n  'July', 'August', 'September', 'October', 'November', 'December'\r\n];\r\n\r\nconst MonthlyReceiptsView = () => {\r\n  const { branchId } = useParams();\r\n  const navigate = useNavigate();\r\n  const printRef = useRef();\r\n  \r\n  const [branchName, setBranchName] = useState('');\r\n  const [loading, setLoading] = useState(true);\r\n  const [selectedYear, setSelectedYear] = useState(new Date().getFullYear());\r\n  const [selectedMonth, setSelectedMonth] = useState(new Date().getMonth() + 1);\r\n  const [reportData, setReportData] = useState(null);\r\n\r\n  // Generate year options (current year and 2 previous)\r\n  const currentYear = new Date().getFullYear();\r\n  const yearOptions = [currentYear, currentYear - 1, currentYear - 2];\r\n\r\n  useEffect(() => {\r\n    const loadBranchName = async () => {\r\n      try {\r\n        const branches = await branchService.getBranches();\r\n        const branch = branches.find(b => b.id === branchId);\r\n        setBranchName(branch?.name || 'Branch');\r\n      } catch (e) {\r\n        console.error('Failed to load branch name', e);\r\n      }\r\n    };\r\n    loadBranchName();\r\n  }, [branchId]);\r\n\r\n  useEffect(() => {\r\n    const loadReport = async () => {\r\n      setLoading(true);\r\n      try {\r\n        const data = await salesService.getMonthlySales(branchId, selectedYear, selectedMonth);\r\n        setReportData(data);\r\n      } catch (error) {\r\n        console.error('Failed to load monthly report', error);\r\n      }\r\n      setLoading(false);\r\n    };\r\n    loadReport();\r\n  }, [branchId, selectedYear, selectedMonth]);\r\n\r\n  const handlePrint = () => {\r\n    window.print();\r\n  };\r\n\r\n  const formatCurrency = (amount, currency) => {\r\n    if (currency === 'USD') return `$${amount.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;\r\n    if (currency === 'IQD') return `${amount.toLocaleString()} IQD`;\r\n    if (currency === 'EUR') return `Γé¼${amount.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;\r\n    return amount.toLocaleString();\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {/* PRINT STYLES */}\r\n      <style>\r\n        {`\r\n          @media print {\r\n            body * { visibility: hidden; }\r\n            #monthly-report-print, #monthly-report-print * { visibility: visible; }\r\n            #monthly-report-print {\r\n              position: absolute;\r\n              left: 0;\r\n              top: 0;\r\n              width: 100%;\r\n              background: white;\r\n              color: black;\r\n              padding: 20px;\r\n            }\r\n            .no-print { display: none !important; }\r\n            @page { margin: 10mm; }\r\n          }\r\n        `}\r\n      </style>\r\n\r\n      <div style={{ padding: '32px', maxWidth: '1200px', margin: '0 auto' }}>\r\n        {/* HEADER */}\r\n        <div className=\"no-print\" style={{ display: 'flex', alignItems: 'center', gap: '16px', marginBottom: '32px' }}>\r\n          <button\r\n            onClick={() => navigate(`/warehouse/branches/${branchId}`)}\r\n            style={{ background: 'none', border: 'none', cursor: 'pointer', display: 'flex', alignItems: 'center' }}\r\n          >\r\n            <ArrowLeft size={24} />\r\n          </button>\r\n          <div>\r\n            <h1 style={{ margin: 0, fontSize: '28px', fontWeight: 700 }}>Monthly Receipts</h1>\r\n            <p style={{ margin: '4px 0 0', color: '#666' }}>{branchName}</p>\r\n          </div>\r\n        </div>\r\n\r\n        {/* FILTERS */}\r\n        <div className=\"no-print\" style={{ display: 'flex', gap: '16px', marginBottom: '24px', flexWrap: 'wrap' }}>\r\n          <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\r\n            <Calendar size={20} color=\"#666\" />\r\n            <select\r\n              value={selectedMonth}\r\n              onChange={(e) => setSelectedMonth(Number(e.target.value))}\r\n              style={{ padding: '10px 16px', borderRadius: '8px', border: '1px solid #ddd', fontSize: '14px', background: '#fff' }}\r\n            >\r\n              {MONTHS.map((name, idx) => (\r\n                <option key={idx} value={idx + 1}>{name}</option>\r\n              ))}\r\n            </select>\r\n            <select\r\n              value={selectedYear}\r\n              onChange={(e) => setSelectedYear(Number(e.target.value))}\r\n              style={{ padding: '10px 16px', borderRadius: '8px', border: '1px solid #ddd', fontSize: '14px', background: '#fff' }}\r\n            >\r\n              {yearOptions.map(year => (\r\n                <option key={year} value={year}>{year}</option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n          \r\n          <button\r\n            onClick={handlePrint}\r\n            style={{\r\n              display: 'flex', alignItems: 'center', gap: '8px',\r\n              padding: '10px 20px', background: '#007AFF', color: '#fff',\r\n              border: 'none', borderRadius: '8px', cursor: 'pointer', fontWeight: 600\r\n            }}\r\n          >\r\n            <Printer size={18} />\r\n            Print Report\r\n          </button>\r\n        </div>\r\n\r\n        {/* PRINTABLE CONTENT */}\r\n        <div id=\"monthly-report-print\" ref={printRef}>\r\n          {/* Print Header (only visible when printing) */}\r\n          <div style={{ display: 'none' }} className=\"print-only\">\r\n            <h1 style={{ textAlign: 'center', marginBottom: '5px' }}>CLOTHING STORE</h1>\r\n            <h2 style={{ textAlign: 'center', marginBottom: '20px' }}>{branchName} - Monthly Report</h2>\r\n            <p style={{ textAlign: 'center', marginBottom: '20px' }}>\r\n              {MONTHS[selectedMonth - 1]} {selectedYear}\r\n            </p>\r\n          </div>\r\n\r\n          {loading ? (\r\n            <div style={{ textAlign: 'center', padding: '60px', color: '#999' }}>Loading report...</div>\r\n          ) : (\r\n            <>\r\n              {/* SUMMARY CARDS */}\r\n              <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '20px', marginBottom: '32px' }}>\r\n                <div style={{ background: '#f8f9fa', padding: '24px', borderRadius: '16px', border: '1px solid #eee' }}>\r\n                  <div style={{ display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '12px' }}>\r\n                    <TrendingUp size={24} color=\"#007AFF\" />\r\n                    <span style={{ fontWeight: 600, color: '#666' }}>Total Sales</span>\r\n                  </div>\r\n                  <div style={{ fontSize: '32px', fontWeight: 700 }}>{reportData?.salesCount || 0}</div>\r\n                </div>\r\n                \r\n                <div style={{ background: '#f8f9fa', padding: '24px', borderRadius: '16px', border: '1px solid #eee' }}>\r\n                  <div style={{ display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '12px' }}>\r\n                    <DollarSign size={24} color=\"#34C759\" />\r\n                    <span style={{ fontWeight: 600, color: '#666' }}>USD Revenue</span>\r\n                  </div>\r\n                  <div style={{ fontSize: '28px', fontWeight: 700, color: '#34C759' }}>\r\n                    {formatCurrency(reportData?.totalUSD || 0, 'USD')}\r\n                  </div>\r\n                </div>\r\n                \r\n                <div style={{ background: '#f8f9fa', padding: '24px', borderRadius: '16px', border: '1px solid #eee' }}>\r\n                  <div style={{ display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '12px' }}>\r\n                    <DollarSign size={24} color=\"#007AFF\" />\r\n                    <span style={{ fontWeight: 600, color: '#666' }}>IQD Revenue</span>\r\n                  </div>\r\n                  <div style={{ fontSize: '24px', fontWeight: 700, color: '#007AFF' }}>\r\n                    {formatCurrency(reportData?.totalIQD || 0, 'IQD')}\r\n                  </div>\r\n                </div>\r\n                \r\n                <div style={{ background: '#f8f9fa', padding: '24px', borderRadius: '16px', border: '1px solid #eee' }}>\r\n                  <div style={{ display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '12px' }}>\r\n                    <DollarSign size={24} color=\"#FF9500\" />\r\n                    <span style={{ fontWeight: 600, color: '#666' }}>EUR Revenue</span>\r\n                  </div>\r\n                  <div style={{ fontSize: '28px', fontWeight: 700, color: '#FF9500' }}>\r\n                    {formatCurrency(reportData?.totalEUR || 0, 'EUR')}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* DAILY BREAKDOWN TABLE */}\r\n              <div style={{ background: '#fff', borderRadius: '16px', border: '1px solid #eee', overflow: 'hidden' }}>\r\n                <div style={{ padding: '20px', borderBottom: '1px solid #eee' }}>\r\n                  <h3 style={{ margin: 0, fontSize: '18px', fontWeight: 600 }}>Daily Breakdown</h3>\r\n                </div>\r\n                \r\n                <table style={{ width: '100%', borderCollapse: 'collapse' }}>\r\n                  <thead>\r\n                    <tr style={{ background: '#f8f9fa' }}>\r\n                      <th style={{ padding: '14px 20px', textAlign: 'left', fontWeight: 600, color: '#666', fontSize: '13px' }}>Date</th>\r\n                      <th style={{ padding: '14px 20px', textAlign: 'center', fontWeight: 600, color: '#666', fontSize: '13px' }}># Sales</th>\r\n                      <th style={{ padding: '14px 20px', textAlign: 'right', fontWeight: 600, color: '#666', fontSize: '13px' }}>USD</th>\r\n                      <th style={{ padding: '14px 20px', textAlign: 'right', fontWeight: 600, color: '#666', fontSize: '13px' }}>IQD</th>\r\n                      <th style={{ padding: '14px 20px', textAlign: 'right', fontWeight: 600, color: '#666', fontSize: '13px' }}>EUR</th>\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody>\r\n                    {reportData?.dailyBreakdown?.length > 0 ? (\r\n                      reportData.dailyBreakdown.map((day, idx) => (\r\n                        <tr key={day.date} style={{ borderBottom: '1px solid #eee' }}>\r\n                          <td style={{ padding: '14px 20px', fontWeight: 500 }}>\r\n                            {new Date(day.date).toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' })}\r\n                          </td>\r\n                          <td style={{ padding: '14px 20px', textAlign: 'center' }}>{day.count}</td>\r\n                          <td style={{ padding: '14px 20px', textAlign: 'right', color: '#34C759' }}>{formatCurrency(day.USD, 'USD')}</td>\r\n                          <td style={{ padding: '14px 20px', textAlign: 'right', color: '#007AFF' }}>{formatCurrency(day.IQD, 'IQD')}</td>\r\n                          <td style={{ padding: '14px 20px', textAlign: 'right', color: '#FF9500' }}>{formatCurrency(day.EUR, 'EUR')}</td>\r\n                        </tr>\r\n                      ))\r\n                    ) : (\r\n                      <tr>\r\n                        <td colSpan={5} style={{ padding: '40px', textAlign: 'center', color: '#999' }}>\r\n                          No sales recorded for {MONTHS[selectedMonth - 1]} {selectedYear}\r\n                        </td>\r\n                      </tr>\r\n                    )}\r\n                  </tbody>\r\n                  {reportData?.dailyBreakdown?.length > 0 && (\r\n                    <tfoot>\r\n                      <tr style={{ background: '#1C1C1E', color: '#fff', fontWeight: 600 }}>\r\n                        <td style={{ padding: '16px 20px' }}>TOTAL</td>\r\n                        <td style={{ padding: '16px 20px', textAlign: 'center' }}>{reportData?.salesCount || 0}</td>\r\n                        <td style={{ padding: '16px 20px', textAlign: 'right', color: '#34C759' }}>{formatCurrency(reportData?.totalUSD || 0, 'USD')}</td>\r\n                        <td style={{ padding: '16px 20px', textAlign: 'right', color: '#007AFF' }}>{formatCurrency(reportData?.totalIQD || 0, 'IQD')}</td>\r\n                        <td style={{ padding: '16px 20px', textAlign: 'right', color: '#FF9500' }}>{formatCurrency(reportData?.totalEUR || 0, 'EUR')}</td>\r\n                      </tr>\r\n                    </tfoot>\r\n                  )}\r\n                </table>\r\n              </div>\r\n\r\n              {/* Print Footer */}\r\n              <div style={{ marginTop: '40px', textAlign: 'center', color: '#999', fontSize: '12px' }}>\r\n                Generated on {new Date().toLocaleString()}\r\n              </div>\r\n            </>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default MonthlyReceiptsView;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\NIPEAL\\Desktop\\ClothingStore\\my-react-app\\src\\features\\warehouse\\branches\\PaymentMethodsView.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[188,227],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'loading' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":11,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"loading"},"fix":{"range":[397,404],"text":""},"desc":"Remove unused variable 'loading'."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadMethods'. Either include it or remove the dependency array.","line":18,"column":6,"nodeType":"ArrayExpression","endLine":18,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [branchId, loadMethods]","fix":{"range":[623,633],"text":"[branchId, loadMethods]"}}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { ArrowLeft, CreditCard, Plus, Trash2, CheckCircle } from 'lucide-react';\r\nimport { useNavigate, useParams } from 'react-router-dom';\r\nimport { motion } from 'framer-motion';\r\n\r\nconst PaymentMethodsView = () => {\r\n  const { branchId } = useParams();\r\n  const navigate = useNavigate();\r\n\r\n  const [methods, setMethods] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [newMethodName, setNewMethodName] = useState('');\r\n  const [showAdd, setShowAdd] = useState(false);\r\n\r\n  // Load Initial Methods\r\n  useEffect(() => {\r\n      loadMethods();\r\n  }, [branchId]);\r\n\r\n  const loadMethods = async () => {\r\n      try {\r\n          const { branchService } = await import('../services/branchService');\r\n          const data = await branchService.getPaymentConfig(branchId);\r\n          setMethods(data);\r\n      } catch (e) {\r\n          console.error(\"Failed to load methods\", e);\r\n      } finally {\r\n          setLoading(false);\r\n      }\r\n  };\r\n\r\n  const handleSaveMethods = async (newMethods) => {\r\n      try {\r\n          const { branchService } = await import('../services/branchService');\r\n          await branchService.updatePaymentConfig(branchId, newMethods);\r\n          setMethods(newMethods);\r\n      } catch (e) {\r\n          console.error(\"Failed to save methods\", e);\r\n          alert(\"Failed to save changes\");\r\n      }\r\n  };\r\n\r\n  const handleAdd = async (e) => {\r\n    e.preventDefault();\r\n    if (!newMethodName) return;\r\n    \r\n    const newMethod = { \r\n        id: Date.now().toString(), \r\n        name: newMethodName, \r\n        icon: '≡ƒÆ│', \r\n        active: true,\r\n        currency: 'USD' // Defaulting to USD for custom methods for now\r\n    };\r\n    \r\n    const updated = [...methods, newMethod];\r\n    await handleSaveMethods(updated);\r\n    \r\n    setNewMethodName('');\r\n    setShowAdd(false);\r\n  };\r\n\r\n  const handleDelete = async (id) => {\r\n    if (window.confirm('Delete this payment method?')) {\r\n      const updated = methods.filter(m => m.id !== id);\r\n      await handleSaveMethods(updated);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div style={{ maxWidth: '800px', margin: '0 auto' }}>\r\n      {/* Header */}\r\n      <div style={{ display: 'flex', alignItems: 'center', gap: '16px', marginBottom: '32px' }}>\r\n        <button \r\n          onClick={() => navigate(`/warehouse/branches/${branchId}`)}\r\n          style={{ \r\n            width: '40px', height: '40px', borderRadius: '12px', \r\n            background: '#FFF', border: '1px solid #E5E5EA', \r\n            display: 'flex', alignItems: 'center', justifyContent: 'center',\r\n            boxShadow: '0 2px 5px rgba(0,0,0,0.03)',\r\n            cursor: 'pointer',\r\n            padding: 0,\r\n            color: '#000'\r\n          }}\r\n        >\r\n          <ArrowLeft size={20} color=\"#000\" />\r\n        </button>\r\n        <div>\r\n          <h1 style={{ fontSize: '24px', fontWeight: 'bold', margin: '0' }}>Payment Methods</h1>\r\n          <p style={{ margin: 0, color: '#888', fontSize: '14px' }}>Configure accepted payment types for POS</p>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Main Card */}\r\n      <motion.div \r\n        initial={{ opacity: 0, y: 10 }}\r\n        animate={{ opacity: 1, y: 0 }}\r\n        className=\"card\" \r\n        style={{ padding: '32px' }}\r\n      >\r\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '24px' }}>\r\n          <h3 style={{ margin: 0, fontSize: '18px', fontWeight: 700 }}>Active Methods</h3>\r\n          <button \r\n            className=\"btn btn-primary\" \r\n            style={{ padding: '8px 16px', fontSize: '13px' }}\r\n            onClick={() => setShowAdd(true)}\r\n          >\r\n            <Plus size={16} style={{ marginRight: '6px' }} /> Add Method\r\n          </button>\r\n        </div>\r\n\r\n        {/* Add Form */}\r\n        {showAdd && (\r\n          <motion.form \r\n            initial={{ opacity: 0, height: 0 }}\r\n            animate={{ opacity: 1, height: 'auto' }}\r\n            onSubmit={handleAdd}\r\n            style={{ display: 'flex', gap: '12px', marginBottom: '24px', padding: '16px', background: '#FAFAFA', borderRadius: '12px' }}\r\n          >\r\n            <input \r\n              className=\"input-field\" \r\n              placeholder=\"Method Name (e.g. Apple Pay)\" \r\n              value={newMethodName} \r\n              onChange={e => setNewMethodName(e.target.value)}\r\n              autoFocus\r\n              style={{ background: '#FFF' }}\r\n            />\r\n            <button type=\"submit\" className=\"btn btn-primary\">Save</button>\r\n            <button type=\"button\" className=\"btn\" onClick={() => setShowAdd(false)}>Cancel</button>\r\n          </motion.form>\r\n        )}\r\n\r\n        {/* List */}\r\n        <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>\r\n          {methods.map(method => (\r\n            <div \r\n              key={method.id}\r\n              style={{ \r\n                display: 'flex', alignItems: 'center', justifyContent: 'space-between',\r\n                padding: '16px 20px', borderRadius: '12px', border: '1px solid #F0F0F0',\r\n                background: '#FFF'\r\n              }}\r\n            >\r\n              <div style={{ display: 'flex', alignItems: 'center', gap: '16px' }}>\r\n                <div style={{ fontSize: '24px' }}>{method.icon}</div>\r\n                <div style={{ fontWeight: 600, fontSize: '16px' }}>{method.name}</div>\r\n              </div>\r\n              \r\n              <div style={{ display: 'flex', alignItems: 'center', gap: '16px' }}>\r\n                <span style={{ \r\n                  fontSize: '11px', fontWeight: 600, color: '#34C759', background: '#E5F9E5', \r\n                  padding: '4px 8px', borderRadius: '20px', display: 'flex', alignItems: 'center', gap: '4px' \r\n                }}>\r\n                  <CheckCircle size={12} /> Active\r\n                </span>\r\n                <button \r\n                  onClick={() => handleDelete(method.id)}\r\n                  style={{ border: 'none', background: 'transparent', cursor: 'pointer', color: '#DDD', padding: '4px' }}\r\n                >\r\n                  <Trash2 size={18} />\r\n                </button>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n\r\n        <div style={{ marginTop: '32px', padding: '16px', borderRadius: '8px', background: '#F5F7FA', fontSize: '13px', color: '#666', lineHeight: '1.5' }}>\r\n          <strong>Note:</strong> These options will appear as buttons on the Cashier (POS) screen checkout. Ensure names are short and clear.\r\n        </div>\r\n      </motion.div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PaymentMethodsView;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\NIPEAL\\Desktop\\ClothingStore\\my-react-app\\src\\features\\warehouse\\dashboard\\WarehouseDashboard.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[161,200],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'Icon' is defined but never used.","line":328,"column":63,"nodeType":"Identifier","messageId":"unusedVar","endLine":328,"endColumn":67,"suggestions":[{"messageId":"removeVar","data":{"varName":"Icon"},"fix":{"range":[14713,14725],"text":""},"desc":"Remove unused variable 'Icon'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { TrendingUp, Store, Users, DollarSign, Activity, Plus, ArrowRight, Wallet, Bell } from 'lucide-react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { motion } from 'framer-motion';\r\nimport { \r\n  AreaChart, Area, XAxis, YAxis, CartesianGrid, Tooltip as RechartsTooltip, ResponsiveContainer,\r\n  BarChart, Bar, Cell\r\n} from 'recharts';\r\nimport NotificationBell from '../../../components/ui/NotificationBell';\r\n\r\n// --- MOCK GLOBAL DATA ---\r\nconst GLOBAL_SALES_DATA = [\r\n  { name: 'Jan', value: 12000 },\r\n  { name: 'Feb', value: 19000 },\r\n  { name: 'Mar', value: 15000 },\r\n  { name: 'Apr', value: 25000 },\r\n  { name: 'May', value: 22000 },\r\n  { name: 'Jun', value: 30000 },\r\n];\r\n\r\nconst BRANCH_PERFORMANCE = [\r\n  { name: 'Downtown', sales: 12500, color: '#007AFF' },\r\n  { name: 'Mall', sales: 18200, color: '#34C759' },\r\n  { name: 'Airport', sales: 8500, color: '#FF9500' },\r\n  { name: 'Westside', sales: 15000, color: '#5856D6' },\r\n];\r\n\r\nconst RECENT_ACTIVITY = [\r\n  { id: 1, type: 'New Branch', text: 'Westside Branch opened', time: '2h ago', icon: Store, color: '#007AFF' },\r\n  { id: 2, type: 'High Sale', text: '$1,200 suit sale at Mall', time: '4h ago', icon: DollarSign, color: '#34C759' },\r\n  { id: 3, type: 'New Staff', text: 'Sarah added to Downtown', time: '1d ago', icon: Users, color: '#5856D6' },\r\n];\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { salesService } from '../../shop/services/salesService';\r\nimport { branchService } from '../services/branchService';\r\nimport { authService } from '../../auth/services/authService';\r\n\r\nconst WarehouseDashboard = () => {\r\n  const navigate = useNavigate();\r\n  \r\n  const [loading, setLoading] = useState(true);\r\n  const [stats, setStats] = useState({\r\n    revenue: 0,\r\n    totalUSD: 0,\r\n    totalIQD: 0,\r\n    totalEUR: 0,\r\n    branches: 0,\r\n    employees: 0,\r\n    expenses: 0\r\n  });\r\n  const [branchPerformance, setBranchPerformance] = useState([]);\r\n  const [recentActivity, setRecentActivity] = useState([]);\r\n\r\n  useEffect(() => {\r\n    const loadGlobalData = async () => {\r\n      try {\r\n        // 1. Fetch Basic Totals\r\n        const [salesStats, branchesList, employeesList] = await Promise.all([\r\n           salesService.getNetworkStats(),\r\n           branchService.getBranches(),\r\n           authService.getEmployees()\r\n        ]);\r\n\r\n        setStats({\r\n          revenue: salesStats.totalRevenue,\r\n          totalUSD: salesStats.totalUSD || 0,\r\n          totalIQD: salesStats.totalIQD || 0,\r\n          totalEUR: salesStats.totalEUR || 0,\r\n          branches: branchesList.length,\r\n          employees: employeesList.length,\r\n          expenses: 0 // TODO: Connect to Expense Service\r\n        });\r\n\r\n        // 2. Format Branch Performance for Chart\r\n        // Match sales branchId to branch Name\r\n        const performanceData = salesStats.branchPerformance.map((bp, idx) => {\r\n           const branch = branchesList.find(b => b.id === bp.id);\r\n           const COLORS = ['#007AFF', '#34C759', '#FF9500', '#5856D6', '#FF2D55'];\r\n           return {\r\n             name: branch ? branch.name.split(' ')[0] : 'Unknown', // Short name\r\n             sales: bp.value,\r\n             color: COLORS[idx % COLORS.length]\r\n           };\r\n        });\r\n        setBranchPerformance(performanceData);\r\n\r\n        // 3. Format Recent Activity\r\n        const activityData = salesStats.recentActivity.map(sale => ({\r\n            id: sale.id,\r\n            type: 'New Sale',\r\n            text: `Sale of $${sale.total} recorded`,\r\n            time: sale.date || 'Today',\r\n            icon: DollarSign,\r\n            color: '#34C759'\r\n        }));\r\n        setRecentActivity(activityData);\r\n\r\n      } catch (error) {\r\n        console.error(\"Dashboard Error\", error);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    loadGlobalData();\r\n  }, []);\r\n\r\n  const containerVariants = {\r\n    hidden: { opacity: 0 },\r\n    visible: { opacity: 1, transition: { staggerChildren: 0.1 } }\r\n  };\r\n\r\n  const itemVariants = {\r\n    hidden: { y: 20, opacity: 0 },\r\n    visible: { y: 0, opacity: 1 }\r\n  };\r\n\r\n  if (loading) return <div style={{ padding: '60px', textAlign: 'center', color: '#888' }}>Loading Global Insight...</div>;\r\n\r\n  return (\r\n    <motion.div \r\n      initial=\"hidden\"\r\n      animate=\"visible\"\r\n      variants={containerVariants}\r\n      style={{ maxWidth: '1200px', margin: '0 auto', paddingBottom: '40px' }}\r\n    >\r\n      {/* HERO HEADER */}\r\n      <motion.div variants={itemVariants} style={{ marginBottom: '40px', display: 'flex', justifyContent: 'space-between', alignItems: 'end' }}>\r\n        <div>\r\n          <h2 style={{ fontSize: '14px', fontWeight: 600, color: '#888', textTransform: 'uppercase', letterSpacing: '1px', marginBottom: '8px' }}>\r\n            Headquarters Overview\r\n          </h2>\r\n          <h1 style={{ fontSize: '32px', fontWeight: '800', margin: 0, background: 'linear-gradient(45deg, #111, #444)', WebkitBackgroundClip: 'text', WebkitTextFillColor: 'transparent' }}>\r\n            Venta Network Admin\r\n          </h1>\r\n        </div>\r\n        <div style={{ display: 'flex', gap: '12px' }}>\r\n          <NotificationBell />\r\n          <button className=\"btn btn-primary\" style={{ boxShadow: '0 4px 12px rgba(0,0,0,0.1)' }}>\r\n            Generate Report\r\n          </button>\r\n        </div>\r\n      </motion.div>\r\n\r\n      {/* STATS OVERVIEW - Modern Dark Cards */}\r\n      <motion.div variants={itemVariants} style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(260px, 1fr))', gap: '24px', marginBottom: '40px' }}>\r\n        <DashboardStat \r\n          title=\"Total Network Revenue\" \r\n          value={\r\n             <div style={{ display:'flex', flexDirection:'column', gap:'4px' }}>\r\n                 <div style={{color:'#34C759', fontSize:'20px'}}>${(stats.totalUSD || 0).toLocaleString()}</div>\r\n                 <div style={{color:'#007AFF', fontSize:'16px'}}>{(stats.totalIQD || 0).toLocaleString()} IQD</div>\r\n                 <div style={{color:'#FF9500', fontSize:'16px'}}>Γé¼{(stats.totalEUR || 0).toLocaleString()}</div>\r\n             </div>\r\n          }\r\n          change=\"+0%\" \r\n          isPositive \r\n          icon={Wallet} \r\n          mainColor=\"#1C1C1E\" \r\n          textColor=\"#FFF\"\r\n        />\r\n        <DashboardStat \r\n          title=\"Active Branches\" \r\n          value={stats.branches} \r\n          subtext=\"Locations\" \r\n          icon={Store} \r\n          mainColor=\"#FFF\" \r\n          textColor=\"#000\"\r\n        />\r\n        <DashboardStat \r\n          title=\"Total Employees\" \r\n          value={stats.employees} \r\n          subtext=\"Active Staff\" \r\n          icon={Users} \r\n          mainColor=\"#FFF\" \r\n          textColor=\"#000\"\r\n        />\r\n        <DashboardStat \r\n          title=\"Monthly Expenses\" \r\n          value=\"$0\" \r\n          change=\"0%\" \r\n          isPositive={true} \r\n          icon={Activity} \r\n          mainColor=\"#FFF\" \r\n          textColor=\"#000\"\r\n        />\r\n      </motion.div>\r\n\r\n      {/* ANALYTICS SECTION */}\r\n      <div className=\"responsive-grid\" style={{ display: 'grid', gridTemplateColumns: '2fr 1fr', gap: '32px', marginBottom: '40px' }}>\r\n        \r\n        {/* Global Sales Area Chart (Keep Mock History for Visuals if Real History Empty) */}\r\n        <motion.div variants={itemVariants} className=\"card\" style={{ padding: '32px', minHeight: '400px', display: 'flex', flexDirection: 'column' }}>\r\n          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '32px' }}>\r\n            <div>\r\n              <h3 style={{ margin: 0, fontSize: '20px', fontWeight: 700 }}>Global Performance</h3>\r\n              <p style={{ margin: '4px 0 0', color: '#999', fontSize: '13px' }}>Aggregated sales across all branches</p>\r\n            </div>\r\n            <div style={{ display: 'flex', gap: '8px' }}>\r\n               <span style={{ fontSize: '12px', fontWeight: 600, padding: '4px 12px', background: '#F0F0F5', borderRadius: '20px', color: '#666' }}>6 Months</span>\r\n            </div>\r\n          </div>\r\n          \r\n          <div style={{ flex: 1, width: '100%' }}>\r\n            <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n              <AreaChart data={GLOBAL_SALES_DATA}> \r\n                <defs>\r\n                  <linearGradient id=\"colorGlobal\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\r\n                    <stop offset=\"5%\" stopColor=\"#111\" stopOpacity={0.1}/>\r\n                    <stop offset=\"95%\" stopColor=\"#111\" stopOpacity={0}/>\r\n                  </linearGradient>\r\n                </defs>\r\n                <CartesianGrid strokeDasharray=\"3 3\" vertical={false} stroke=\"#E5E5EA\" />\r\n                <XAxis dataKey=\"name\" axisLine={false} tickLine={false} tick={{fill: '#999', fontSize: 12}} dy={10} />\r\n                <YAxis axisLine={false} tickLine={false} tick={{fill: '#999', fontSize: 12}} />\r\n                <RechartsTooltip \r\n                   contentStyle={{ borderRadius: '12px', border: 'none', boxShadow: '0 4px 20px rgba(0,0,0,0.1)' }} \r\n                   cursor={{ stroke: '#111', strokeWidth: 1 }}\r\n                />\r\n                <Area type=\"monotone\" dataKey=\"value\" stroke=\"#111\" strokeWidth={3} fillOpacity={1} fill=\"url(#colorGlobal)\" />\r\n              </AreaChart>\r\n            </ResponsiveContainer>\r\n          </div>\r\n        </motion.div>\r\n\r\n        {/* Branch Comparison Bar Chart */}\r\n        <motion.div variants={itemVariants} className=\"card\" style={{ padding: '32px', minHeight: '400px', display: 'flex', flexDirection: 'column' }}>\r\n          <h3 style={{ margin: '0 0 8px', fontSize: '18px', fontWeight: 700 }}>Top Branches</h3>\r\n          <p style={{ margin: '0 0 24px', color: '#999', fontSize: '13px' }}>Sales by location this month</p>\r\n          \r\n          <div style={{ flex: 1, width: '100%' }}>\r\n            {branchPerformance.length > 0 ? (\r\n                <ResponsiveContainer width=\"100%\" height=\"80%\">\r\n                <BarChart data={branchPerformance} layout=\"vertical\" margin={{ left: 0 }}>\r\n                    <XAxis type=\"number\" hide />\r\n                    <YAxis dataKey=\"name\" type=\"category\" axisLine={false} tickLine={false} width={80} tick={{ fontSize: 13, fontWeight: 500 }} />\r\n                    <RechartsTooltip cursor={{fill: 'transparent'}} contentStyle={{ borderRadius: '8px' }} />\r\n                    <Bar dataKey=\"sales\" radius={[0, 4, 4, 0]} barSize={20}>\r\n                    {branchPerformance.map((entry, index) => (\r\n                        <Cell key={`cell-${index}`} fill={entry.color} />\r\n                    ))}\r\n                    </Bar>\r\n                </BarChart>\r\n                </ResponsiveContainer> \r\n            ) : (\r\n                <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', height: '100%', color: '#CCC', fontSize: '13px' }}>\r\n                    No branch data available yet\r\n                </div>\r\n            )}\r\n            \r\n            {/* Legend / Info */}\r\n            <div style={{ borderTop: '1px solid #eee', paddingTop: '16px', marginTop: 'auto' }}>\r\n               <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n                 <span style={{ fontSize: '13px', color: '#666' }}>Top Performer</span>\r\n                 {branchPerformance.length > 0 && <span style={{ fontSize: '13px', fontWeight: 'bold' }}>{branchPerformance[0].name} (${branchPerformance[0].sales})</span>}\r\n               </div>\r\n            </div>\r\n          </div>\r\n        </motion.div>\r\n      </div>\r\n\r\n      {/* BOTTOM ROW: Activity & Quick Actions */}\r\n      <div className=\"responsive-grid\" style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '32px' }}>\r\n        \r\n        {/* Recent Activity */}\r\n        <motion.div variants={itemVariants} className=\"card\" style={{ padding: '32px' }}>\r\n          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '24px' }}>\r\n            <h3 style={{ margin: 0, fontSize: '18px', fontWeight: 700 }}>Recent Updates</h3>\r\n            <button className=\"btn\" style={{ padding: '4px 12px', fontSize: '12px' }}>View All</button>\r\n          </div>\r\n          \r\n          <div style={{ display: 'flex', flexDirection: 'column', gap: '20px' }}>\r\n            {recentActivity.length > 0 ? recentActivity.map(act => (\r\n              <div key={act.id} style={{ display: 'flex', alignItems: 'center', gap: '16px' }}>\r\n                <div style={{ \r\n                  width: '40px', height: '40px', borderRadius: '10px', \r\n                  background: `${act.color}15`, color: act.color,\r\n                  display: 'flex', alignItems: 'center', justifyContent: 'center'\r\n                }}>\r\n                  <act.icon size={20} />\r\n                </div>\r\n                <div style={{ flex: 1 }}>\r\n                  <div style={{ fontSize: '14px', fontWeight: 600 }}>{act.type}</div>\r\n                  <div style={{ fontSize: '13px', color: '#666' }}>{act.text}</div>\r\n                </div>\r\n                <span style={{ fontSize: '12px', color: '#999' }}>{act.time}</span>\r\n              </div>\r\n            )) : (\r\n                <div style={{ padding: '20px', textAlign: 'center', color: '#CCC', fontSize: '13px' }}>\r\n                    No recent activity\r\n                </div>\r\n            )}\r\n          </div>\r\n        </motion.div>\r\n\r\n        {/* Quick Actions */}\r\n        <motion.div variants={itemVariants}>\r\n           <h3 style={{ marginBottom: '16px', fontSize: '18px', fontWeight: 700 }}>Quick Actions</h3>\r\n           <div style={{ display: 'grid', gridTemplateColumns: '1fr', gap: '16px' }}>\r\n             \r\n             <button \r\n               onClick={() => navigate('/warehouse/branches')}\r\n               className=\"card\" \r\n               style={{ \r\n                 padding: '24px', border: 'none', cursor: 'pointer', textAlign: 'left',\r\n                 background: 'linear-gradient(135deg, #007AFF, #0056B3)', color: '#FFF',\r\n                 display: 'flex', flexDirection: 'column', justifyContent: 'space-between', minHeight: '140px'\r\n               }}\r\n             >\r\n               <div style={{ background: 'rgba(255,255,255,0.2)', width: 'fit-content', padding: '8px', borderRadius: '8px' }}>\r\n                 <Store size={24} />\r\n               </div>\r\n               <div>\r\n                  <div style={{ opacity: 0.8, fontSize: '12px' }}>Network Growth</div>\r\n                  <div style={{ fontSize: '16px', fontWeight: 'bold', marginTop: '4px' }}>Add Branch</div>\r\n               </div>\r\n             </button>\r\n\r\n           </div>\r\n        </motion.div>\r\n\r\n      </div>\r\n    </motion.div>\r\n  );\r\n};\r\n\r\n// --- SUB COMPONENTS ---\r\n\r\nconst DashboardStat = ({ title, value, change, subtext, icon: Icon, mainColor, textColor, isPositive }) => (\r\n  <motion.div \r\n    whileHover={{ y: -5 }}\r\n    className=\"card\" \r\n    style={{ \r\n      padding: '24px', background: mainColor, color: textColor, border: 'none',\r\n      display: 'flex', flexDirection: 'column', justifyContent: 'space-between',\r\n      boxShadow: mainColor === '#FFF' ? '0 4px 20px rgba(0,0,0,0.05)' : '0 10px 30px rgba(0,0,0,0.2)'\r\n    }}\r\n  >\r\n    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'start', marginBottom: '16px' }}>\r\n      <div style={{ \r\n        padding: '10px', \r\n        borderRadius: '12px', \r\n        background: mainColor === '#FFF' ? '#F5F5F7' : 'rgba(255,255,255,0.1)', \r\n        color: mainColor === '#FFF' ? '#000' : '#FFF' \r\n      }}>\r\n        <Icon size={22} />\r\n      </div>\r\n      {change && (\r\n        <span style={{ \r\n          fontSize: '12px', fontWeight: 600, padding: '4px 8px', borderRadius: '20px',\r\n          background: isPositive ? 'rgba(52, 199, 89, 0.15)' : 'rgba(255, 59, 48, 0.15)',\r\n          color: isPositive ? '#34C759' : '#FF3B30'\r\n        }}>\r\n          {change}\r\n        </span>\r\n      )}\r\n    </div>\r\n    <div>\r\n      <div style={{ fontSize: '13px', opacity: 0.6, fontWeight: 500, marginBottom: '4px' }}>{title}</div>\r\n      <div style={{ fontSize: '28px', fontWeight: 'bold' }}>{value}</div>\r\n      {subtext && <div style={{ fontSize: '12px', opacity: 0.5, marginTop: '4px' }}>{subtext}</div>}\r\n    </div>\r\n  </motion.div>\r\n);\r\n\r\nexport default WarehouseDashboard;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\NIPEAL\\Desktop\\ClothingStore\\my-react-app\\src\\features\\warehouse\\inventory\\BranchInventoryForm.jsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadItemForEdit'. Either include it or remove the dependency array.","line":56,"column":6,"nodeType":"ArrayExpression","endLine":56,"endColumn":14,"suggestions":[{"desc":"Update the dependencies array to be: [itemId, loadItemForEdit]","fix":{"range":[1709,1717],"text":"[itemId, loadItemForEdit]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { ArrowLeft, Save, Camera, Plus, Trash2, Barcode } from 'lucide-react';\r\nimport { useNavigate, useParams } from 'react-router-dom';\r\nimport { useState, useEffect } from 'react';\r\nimport { inventoryService } from './inventoryService';\r\nimport { useAuth } from '../../auth/AuthContext';\r\nimport { useNotification } from '../../../components/ui/NotificationContext';\r\n\r\nconst BranchInventoryForm = () => {\r\n  const { branchId, itemId } = useParams();\r\n  const navigate = useNavigate();\r\n\r\n  // Basic Details\r\n  const [formData, setFormData] = useState({\r\n    barcode: '',\r\n    name: '',\r\n    category: '',\r\n    brand: '',\r\n    material: '',\r\n    description: '',\r\n    costPrice: '',\r\n    sellPrice: '',\r\n    currency: 'USD', // Default currency\r\n    discount: '',\r\n    imageUrl: null,\r\n  });\r\n\r\n  // Variants (Color/Size/Stock)\r\n  const [variants, setVariants] = useState([\r\n    { id: 1, color: '', size: '', quantity: 0 }\r\n  ]);\r\n\r\n  const [imagePreview, setImagePreview] = useState(null);\r\n  const [imageFile, setImageFile] = useState(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [isEditMode, setIsEditMode] = useState(false);\r\n  const [categories, setCategories] = useState([]);\r\n\r\n  // Load Item Validation & Categories\r\n  useEffect(() => {\r\n    const init = async () => {\r\n        // 1. Load Categories\r\n        try {\r\n            const cats = await inventoryService.getCategories();\r\n            setCategories(cats);\r\n        } catch (e) { \r\n            console.error(\"Error loading categories\", e);\r\n        }\r\n\r\n        // 2. Load Item if Edit Mode\r\n        if (itemId) {\r\n            setIsEditMode(true);\r\n            loadItemForEdit();\r\n        }\r\n    };\r\n    init();\r\n  }, [itemId]);\r\n\r\n  const loadItemForEdit = async () => {\r\n      try {\r\n          const item = await inventoryService.getItemById(itemId);\r\n          if (item) {\r\n              setFormData({\r\n                  barcode: item.barcode || '',\r\n                  name: item.name || '',\r\n                  category: item.category || '',\r\n                  brand: item.brand || '',\r\n                  material: item.material || '',\r\n                  description: item.description || '',\r\n                  costPrice: item.costPrice || '',\r\n                  sellPrice: item.sellPrice || '',\r\n                  priceIQD: item.priceIQD || '',\r\n                  priceEUR: item.priceEUR || '',\r\n                  discount: item.discount || '',\r\n                  imageUrl: item.imageUrl || null\r\n              });\r\n              if(item.imageUrl) setImagePreview(item.imageUrl);\r\n              if(item.variants) setVariants(item.variants);\r\n          }\r\n      } catch (error) {\r\n          console.error(\"Failed to load item\", error);\r\n      }\r\n  };\r\n\r\n  const handleInputChange = (e) => {\r\n    setFormData({ ...formData, [e.target.name]: e.target.value });\r\n  };\r\n\r\n  const handleVariantChange = (id, field, value) => {\r\n    setVariants(variants.map(v => v.id === id ? { ...v, [field]: value } : v));\r\n  };\r\n\r\n  const addVariant = () => {\r\n    setVariants([...variants, { id: Date.now(), color: '', size: '', quantity: 0 }]);\r\n  };\r\n\r\n  const removeVariant = (id) => {\r\n    setVariants(variants.filter(v => v.id !== id));\r\n  };\r\n\r\n  const handleImageChange = (e) => {\r\n    const file = e.target.files[0];\r\n    if (file) {\r\n      setImageFile(file);\r\n      setImagePreview(URL.createObjectURL(file));\r\n    }\r\n  };\r\n\r\n  const calculateTotalStock = () => variants.reduce((acc, curr) => acc + Number(curr.quantity), 0);\r\n\r\n  // Notification Hook\r\n  const { showNotification } = useNotification();\r\n\r\n  const handleSave = async () => {\r\n    if (!formData.barcode || !formData.name || !formData.sellPrice) {\r\n      showNotification(\"Please fill in required fields (Barcode, Name, Price)\", 'error');\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    try {\r\n      let imageUrl = formData.imageUrl; // Keep existing if no new file\r\n\r\n      // Upload Image if selected\r\n      if (imageFile) {\r\n          const { ref, uploadBytes, getDownloadURL } = await import(\"firebase/storage\");\r\n          const { storage } = await import(\"../../../lib/firebase\");\r\n          \r\n          const storageRef = ref(storage, `items/${Date.now()}_${imageFile.name}`);\r\n          const snapshot = await uploadBytes(storageRef, imageFile);\r\n          imageUrl = await getDownloadURL(snapshot.ref);\r\n      }\r\n\r\n      const payload = {\r\n        ...formData,\r\n        branchId,\r\n        imageUrl: imageUrl || null, \r\n        variants,\r\n        sellPrice: Number(formData.sellPrice) || 0, // USD Base\r\n        priceIQD: Number(formData.priceIQD) || 0,\r\n        priceEUR: Number(formData.priceEUR) || 0,\r\n        costPrice: Number(formData.costPrice) || 0,\r\n        discount: Number(formData.discount || 0),\r\n        stock: calculateTotalStock() \r\n      };\r\n\r\n      if (isEditMode) {\r\n          await inventoryService.updateItem(itemId, payload);\r\n          showNotification(\"Item updated successfully!\", 'success');\r\n      } else {\r\n          await inventoryService.addItem(payload);\r\n          showNotification(\"Item added successfully!\", 'success');\r\n      }\r\n      setTimeout(() => navigate(`/warehouse/branches/${branchId}`), 1000); // Delay slightly for effect\r\n    } catch (error) {\r\n      console.error(error);\r\n      showNotification(\"Error saving item: \" + error.message, 'error');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Check Permissions\r\n  const { hasPermission } = useAuth();\r\n  if (!hasPermission('INVENTORY_WRITE')) {\r\n      return (\r\n        <div style={{ maxWidth: '600px', margin: '100px auto', textAlign: 'center', padding: '40px' }} className=\"card\">\r\n            <h2 style={{ fontSize: '24px', marginBottom: '16px' }}>Access Denied</h2>\r\n            <p style={{ color: '#666' }}>You do not have permission to add or edit inventory items.</p>\r\n            <button \r\n                className=\"btn btn-primary\" \r\n                style={{ marginTop: '24px' }}\r\n                onClick={() => navigate(`/warehouse/branches/${branchId}`)}\r\n            >\r\n                Return to Dashboard\r\n            </button>\r\n        </div>\r\n      );\r\n  }\r\n\r\n  return (\r\n    <div style={{ maxWidth: '900px', margin: '0 auto', paddingBottom: '40px' }}>\r\n      <div style={{ display: 'flex', alignItems: 'center', gap: '16px', marginBottom: '32px' }}>\r\n        <button \r\n          onClick={() => navigate(`/warehouse/branches/${branchId}`)}\r\n          className=\"btn\"\r\n          style={{ padding: '8px', background: 'transparent', border: '1px solid var(--color-border)' }}\r\n        >\r\n          <ArrowLeft size={20} />\r\n        </button>\r\n        <div>\r\n          <h1 style={{ fontSize: '24px', fontWeight: 'bold', margin: '0' }}>{isEditMode ? 'Edit Item' : 'Add New Item'}</h1>\r\n          <p style={{ margin: 0, color: 'var(--color-text-secondary)', fontSize: '14px' }}>{isEditMode ? 'Modify existing details' : 'Insert product details into branch inventory'}</p>\r\n        </div>\r\n      </div>\r\n\r\n      <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr', gap: '32px' }}>\r\n        \r\n        {/* LEFT COLUMN: Main Form */}\r\n        <div className=\"card\">\r\n          <h3 style={{ margin: '0 0 24px', fontSize: '18px' }}>Product Details</h3>\r\n          \r\n          {/* Barcode - CRITICAL */}\r\n          <div style={{ marginBottom: '24px' }}>\r\n            <label style={{ display: 'block', marginBottom: '8px', fontWeight: 600 }}>Item Barcode (Manual Entry) <span style={{ color: 'red' }}>*</span></label>\r\n            <div style={{ display: 'flex', gap: '8px' }}>\r\n              <div style={{ position: 'relative', flex: 1 }}>\r\n                <Barcode size={20} style={{ position: 'absolute', left: '12px', top: '12px', color: '#999' }} />\r\n                <input \r\n                  name=\"barcode\"\r\n                  className=\"input-field\" \r\n                  style={{ paddingLeft: '40px', fontFamily: 'monospace', letterSpacing: '1px', fontWeight: 'bold' }}\r\n                  placeholder=\"Type barcode digits...\"\r\n                  value={formData.barcode}\r\n                  onChange={handleInputChange}\r\n                  autoFocus\r\n                />\r\n              </div>\r\n              <button className=\"btn\" style={{ background: '#F5F5F7' }}>Auto-Generate</button>\r\n            </div>\r\n            <div style={{ fontSize: '12px', color: '#888', marginTop: '6px' }}>\r\n              Type the code manually. Scanning is reserved for the POS screen.\r\n            </div>\r\n          </div>\r\n\r\n          <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '20px', marginBottom: '20px' }}>\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '8px', fontSize: '14px', fontWeight: 500 }}>Item Name</label>\r\n              <input name=\"name\" className=\"input-field\" placeholder=\"e.g. Slim Fit Denim\" value={formData.name} onChange={handleInputChange} />\r\n            </div>\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '8px', fontSize: '14px', fontWeight: 500 }}>Category</label>\r\n              <select name=\"category\" className=\"input-field\" value={formData.category} onChange={handleInputChange}>\r\n                <option value=\"\">Select Category</option>\r\n                {categories.map(cat => (\r\n                    <option key={cat.id} value={cat.name}>{cat.name}</option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n          </div>\r\n\r\n          <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '20px', marginBottom: '20px' }}>\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '8px', fontSize: '14px', fontWeight: 500 }}>Brand</label>\r\n              <input name=\"brand\" className=\"input-field\" placeholder=\"e.g. Nike, Zara\" value={formData.brand} onChange={handleInputChange} />\r\n            </div>\r\n             <div>\r\n              <label style={{ display: 'block', marginBottom: '8px', fontSize: '14px', fontWeight: 500 }}>Material / Fabric</label>\r\n              <input name=\"material\" className=\"input-field\" placeholder=\"e.g. 100% Cotton\" value={formData.material} onChange={handleInputChange} />\r\n            </div>\r\n          </div>\r\n\r\n          <div style={{ marginBottom: '24px' }}>\r\n            <label style={{ display: 'block', marginBottom: '8px', fontSize: '14px', fontWeight: 500 }}>Description</label>\r\n            <textarea name=\"description\" className=\"input-field\" rows=\"3\" placeholder=\"Additional details...\" value={formData.description} onChange={handleInputChange} />\r\n          </div>\r\n\r\n          <h4 style={{ margin: '0 0 16px', fontSize: '16px', borderTop: '1px solid #eee', paddingTop: '16px' }}>Pricing (Multi-Currency)</h4>\r\n          \r\n          <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr 1fr', gap: '20px', marginBottom: '20px' }}>\r\n            <div className=\"form-group\">\r\n              <label style={{ display: 'block', marginBottom: '8px', fontSize: '14px', fontWeight: 500 }}>Price (USD) <span style={{color:'red'}}>*</span></label>\r\n              <div style={{position:'relative'}}>\r\n                  <span style={{position:'absolute', left:'12px', top:'12px', color:'#888'}}>$</span>\r\n                  <input \r\n                    type=\"number\" \r\n                    name=\"sellPrice\"\r\n                    className=\"input-field\"\r\n                    value={formData.sellPrice} \r\n                    onChange={handleInputChange}\r\n                    placeholder=\"0.00\"\r\n                    style={{paddingLeft:'28px'}}\r\n                    required\r\n                  />\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"form-group\">\r\n              <label style={{ display: 'block', marginBottom: '8px', fontSize: '14px', fontWeight: 500 }}>Price (IQD)</label>\r\n              <div style={{position:'relative'}}>\r\n                  <span style={{position:'absolute', left:'12px', top:'12px', color:'#888'}}>IQD</span>\r\n                  <input \r\n                    type=\"number\" \r\n                    name=\"priceIQD\"\r\n                    className=\"input-field\"\r\n                    value={formData.priceIQD || ''} \r\n                    onChange={handleInputChange}\r\n                    placeholder=\"0\"\r\n                    style={{paddingLeft:'45px'}}\r\n                  />\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"form-group\">\r\n              <label style={{ display: 'block', marginBottom: '8px', fontSize: '14px', fontWeight: 500 }}>Price (EUR)</label>\r\n              <div style={{position:'relative'}}>\r\n                  <span style={{position:'absolute', left:'12px', top:'12px', color:'#888'}}>Γé¼</span>\r\n                  <input \r\n                    type=\"number\" \r\n                    name=\"priceEUR\"\r\n                    className=\"input-field\"\r\n                    value={formData.priceEUR || ''} \r\n                    onChange={handleInputChange}\r\n                    placeholder=\"0.00\"\r\n                    style={{paddingLeft:'28px'}}\r\n                  />\r\n              </div>\r\n            </div>\r\n          </div>\r\n          \r\n          <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '20px' }}>\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '8px', fontSize: '14px', fontWeight: 500 }}>Cost Price (USD)</label>\r\n              <input name=\"costPrice\" type=\"number\" className=\"input-field\" placeholder=\"0.00\" value={formData.costPrice} onChange={handleInputChange} />\r\n            </div>\r\n            <div>\r\n              <label style={{ display: 'block', marginBottom: '8px', fontSize: '14px', fontWeight: 500 }}>Discount (%)</label>\r\n              <input name=\"discount\" type=\"number\" className=\"input-field\" placeholder=\"0\" value={formData.discount || ''} onChange={handleInputChange} />\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* RIGHT COLUMN: Image & Variants */}\r\n        <div style={{ display: 'flex', flexDirection: 'column', gap: '24px' }}>\r\n          \r\n          {/* Image Upload */}\r\n          <div className=\"card\" style={{ textAlign: 'center' }}>\r\n            <h4 style={{ margin: '0 0 16px', fontSize: '16px' }}>Item Image</h4>\r\n            <div style={{ \r\n              width: '100%', aspectRatio: '1', background: '#F5F5F7', borderRadius: '12px', \r\n              display: 'flex', alignItems: 'center', justifyContent: 'center', marginBottom: '16px',\r\n              overflow: 'hidden', border: '2px dashed #E5E5EA', position: 'relative'\r\n            }}>\r\n              {imagePreview ? (\r\n                <img src={imagePreview} alt=\"Preview\" style={{ width: '100%', height: '100%', objectFit: 'cover' }} />\r\n              ) : (\r\n                <div style={{ color: '#999' }}>\r\n                  <Camera size={32} style={{ marginBottom: '8px' }} />\r\n                  <div style={{ fontSize: '12px' }}>Upload Optional</div>\r\n                </div>\r\n              )}\r\n              <input \r\n                type=\"file\" \r\n                accept=\"image/*\" \r\n                onChange={handleImageChange}\r\n                style={{ position: 'absolute', width: '100%', height: '100%', opacity: 0, cursor: 'pointer' }} \r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          {/* Variants (Colors & Sizes) */}\r\n          <div className=\"card\">\r\n             <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '16px' }}>\r\n              <h3 style={{ margin: 0, fontSize: '16px' }}>Variants & Stock</h3>\r\n            </div>\r\n            \r\n            <div style={{ background: '#F9F9F9', borderRadius: '8px', padding: '12px' }}>\r\n               <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr 1fr auto', gap: '8px', marginBottom: '8px', fontSize: '12px', fontWeight: 600, color: '#666' }}>\r\n                 <div>Color</div>\r\n                 <div>Size</div>\r\n                 <div>Qty</div>\r\n                 <div></div>\r\n               </div>\r\n               \r\n               {variants.map((variant) => (\r\n                 <div key={variant.id} style={{ display: 'grid', gridTemplateColumns: '1fr 1fr 1fr auto', gap: '8px', marginBottom: '8px' }}>\r\n                   <input \r\n                     placeholder=\"Red\" \r\n                     className=\"input-field\" \r\n                     style={{ padding: '8px' }}\r\n                     value={variant.color}\r\n                     onChange={e => handleVariantChange(variant.id, 'color', e.target.value)}\r\n                   />\r\n                   <input \r\n                     placeholder=\"L\" \r\n                     className=\"input-field\" \r\n                     style={{ padding: '8px' }}\r\n                     value={variant.size}\r\n                     onChange={e => handleVariantChange(variant.id, 'size', e.target.value)}\r\n                   />\r\n                   <input \r\n                     type=\"number\" \r\n                     placeholder=\"0\" \r\n                     className=\"input-field\" \r\n                     style={{ padding: '8px' }}\r\n                     value={variant.quantity}\r\n                     onChange={e => handleVariantChange(variant.id, 'quantity', e.target.value)}\r\n                   />\r\n                   <button \r\n                    className=\"btn\" \r\n                    style={{ padding: '8px', color: '#D00' }}\r\n                    onClick={() => removeVariant(variant.id)}\r\n                   >\r\n                     <Trash2 size={14} />\r\n                   </button>\r\n                 </div>\r\n               ))}\r\n\r\n               <button \r\n                 onClick={addVariant}\r\n                 className=\"btn\" \r\n                 style={{ width: '100%', marginTop: '8px', background: '#FFF', border: '1px solid #DDD', fontSize: '13px' }}\r\n               >\r\n                 <Plus size={14} style={{ marginRight: '6px' }} /> Add Variant\r\n               </button>\r\n            </div>\r\n            \r\n            <div style={{ marginTop: '16px', display: 'flex', justifyContent: 'space-between', fontWeight: 600 }}>\r\n              <span>Total Stock:</span>\r\n              <span>{calculateTotalStock()}</span>\r\n            </div>\r\n          </div>\r\n\r\n          <button \r\n            className=\"btn btn-primary\" \r\n            style={{ padding: '16px', fontSize: '16px', opacity: loading ? 0.7 : 1 }}\r\n            onClick={handleSave}\r\n            disabled={loading}\r\n          >\r\n            <Save size={20} style={{ marginRight: '8px' }} />\r\n            {loading ? 'Saving...' : (isEditMode ? 'Update Item' : 'Save Item to Inventory')}\r\n          </button>\r\n\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default BranchInventoryForm;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\NIPEAL\\Desktop\\ClothingStore\\my-react-app\\src\\features\\warehouse\\inventory\\BranchInventoryView.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":6,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[327,366],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'loading' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":15,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"loading"},"fix":{"range":[585,592],"text":""},"desc":"Remove unused variable 'loading'."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadInventory'. Either include it or remove the dependency array.","line":21,"column":6,"nodeType":"ArrayExpression","endLine":21,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [branchId, loadInventory]","fix":{"range":[759,769],"text":"[branchId, loadInventory]"}}]},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":39,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":39,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'Icon' is defined but never used.","line":184,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":184,"endColumn":45,"suggestions":[{"messageId":"removeVar","data":{"varName":"Icon"},"fix":{"range":[8244,8256],"text":""},"desc":"Remove unused variable 'Icon'."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport { inventoryService } from './inventoryService';\r\nimport { ArrowLeft, Plus, Search, Filter, Trash2, Edit2, Package, AlertCircle, DollarSign } from 'lucide-react';\r\nimport { useAuth } from '../../auth/AuthContext';\r\nimport { motion } from 'framer-motion';\r\n\r\nconst BranchInventoryView = () => {\r\n  const { branchId } = useParams();\r\n  const navigate = useNavigate();\r\n  const { hasPermission } = useAuth();\r\n\r\n  // State\r\n  const [items, setItems] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n\r\n  // Fetch Inventory on Mount\r\n  useEffect(() => {\r\n    loadInventory();\r\n  }, [branchId]);\r\n\r\n  const loadInventory = async () => {\r\n    try {\r\n      const data = await inventoryService.getBranchInventory(branchId);\r\n      setItems(data);\r\n    } catch (error) {\r\n      console.error(\"Failed to load inventory\", error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (id) => {\r\n    if (window.confirm('Delete this item from inventory?')) {\r\n      try {\r\n        await inventoryService.deleteItem(id);\r\n        setItems(items.filter(i => i.id !== id));\r\n      } catch (error) {\r\n        alert(\"Failed to delete item\");\r\n      }\r\n    }\r\n  };\r\n\r\n  const containerVariants = {\r\n    hidden: { opacity: 0 },\r\n    visible: { opacity: 1, transition: { staggerChildren: 0.1 } }\r\n  };\r\n\r\n  const itemVariants = {\r\n    hidden: { y: 20, opacity: 0 },\r\n    visible: { y: 0, opacity: 1 }\r\n  };\r\n\r\n  // Safe filtering\r\n  const filteredItems = items.filter(item => \r\n    (item.name || '').toLowerCase().includes(searchTerm.toLowerCase()) || \r\n    (item.barcode || '').includes(searchTerm)\r\n  );\r\n\r\n  // Stats Calculation\r\n  const totalItems = items.length;\r\n  const stockValue = items.reduce((acc, i) => acc + ((Number(i.sellPrice) || 0) * (calculateStock(i.variants))), 0);\r\n  const lowStockCount = items.filter(i => calculateStock(i.variants) < 5).length;\r\n\r\n  function calculateStock(variants) {\r\n    if (!variants) return 0;\r\n    return variants.reduce((acc, v) => acc + (Number(v.quantity) || 0), 0);\r\n  }\r\n\r\n  return (\r\n    <motion.div \r\n      initial=\"hidden\"\r\n      animate=\"visible\"\r\n      variants={containerVariants}\r\n      style={{ maxWidth: '1200px', margin: '0 auto', paddingBottom: '40px' }}\r\n    >\r\n      {/* Header */}\r\n      <motion.div variants={itemVariants} style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '32px' }}>\r\n        <div style={{ display: 'flex', alignItems: 'center', gap: '16px' }}>\r\n          <button \r\n            onClick={() => navigate(`/warehouse/branches/${branchId}`)}\r\n            className=\"btn\"\r\n            style={{ width: '40px', height: '40px', borderRadius: '12px', background: '#FFF', border: '1px solid #E5E5EA', display: 'flex', alignItems: 'center', justifyContent: 'center' }}\r\n          >\r\n            <ArrowLeft size={20} color=\"#555\" />\r\n          </button>\r\n          <div>\r\n            <h1 style={{ fontSize: '24px', fontWeight: 'bold', margin: '0 0 4px' }}>Inventory Management</h1>\r\n            <p style={{ margin: 0, color: '#888', fontSize: '14px' }}>Track stock, edit details, and analyze value</p>\r\n          </div>\r\n        </div>\r\n        \r\n        {hasPermission('INVENTORY_WRITE') && (\r\n            <button \r\n            className=\"btn btn-primary\"\r\n            onClick={() => navigate(`/warehouse/branches/${branchId}/add-item`)}\r\n            >\r\n            <Plus size={20} style={{ marginRight: '8px' }} /> Add New Item\r\n            </button>\r\n        )}\r\n      </motion.div>\r\n\r\n      {/* Stats Cards */}\r\n      <motion.div variants={itemVariants} style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(240px, 1fr))', gap: '24px', marginBottom: '32px' }}>\r\n        <StatCard title=\"Total Items\" value={totalItems} icon={Package} color=\"#007AFF\" />\r\n        <StatCard title=\"Stock Value (Est)\" value={`${stockValue.toLocaleString()}`} icon={DollarSign} color=\"#34C759\" />\r\n        <StatCard title=\"Low Stock Alerts\" value={lowStockCount} icon={AlertCircle} color=\"#FF9500\" />\r\n      </motion.div>\r\n\r\n      {/* Main Content */}\r\n      <motion.div variants={itemVariants} className=\"card\" style={{ padding: '0', overflow: 'hidden', minHeight: '500px' }}>\r\n        \r\n        {/* Toolbar */}\r\n        <div style={{ padding: '24px', borderBottom: '1px solid #E5E5EA', display: 'flex', gap: '16px', background: '#FAFAFA' }}>\r\n          <div style={{ position: 'relative', flex: 1, maxWidth: '400px' }}>\r\n            <Search size={18} style={{ position: 'absolute', left: '12px', top: '11px', color: '#999' }} />\r\n            <input \r\n              className=\"input-field\" \r\n              placeholder=\"Search by name or barcode...\" \r\n              value={searchTerm}\r\n              onChange={e => setSearchTerm(e.target.value)}\r\n              style={{ paddingLeft: '40px', borderRadius: '20px' }} \r\n            />\r\n          </div>\r\n          <button className=\"btn\" style={{ background: '#FFF', border: '1px solid #DDD', padding: '0 16px' }}>\r\n            <Filter size={18} style={{ marginRight: '8px' }} /> Filter\r\n          </button>\r\n        </div>\r\n\r\n        {/* Table */}\r\n        <table style={{ width: '100%', borderCollapse: 'collapse' }}>\r\n          <thead style={{ background: '#FFF', borderBottom: '1px solid #eee' }}>\r\n            <tr style={{ textAlign: 'left', color: '#888', fontSize: '12px', textTransform: 'uppercase' }}>\r\n              <th style={{ padding: '16px 24px' }}>Product</th>\r\n              <th style={{ padding: '16px' }}>Category</th>\r\n              <th style={{ padding: '16px' }}>Stock</th>\r\n              <th style={{ padding: '16px' }}>Price</th>\r\n              {hasPermission('INVENTORY_WRITE') && <th style={{ padding: '16px 24px', textAlign: 'right' }}>Actions</th>}\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {filteredItems.map(item => (\r\n              <tr key={item.id} style={{ borderBottom: '1px solid #F9F9F9' }}>\r\n                <td style={{ padding: '16px 24px' }}>\r\n                  <div style={{ fontWeight: 600, fontSize: '14px' }}>{item.name}</div>\r\n                  <div style={{ fontSize: '12px', color: '#999', fontFamily: 'monospace' }}>#{item.barcode}</div>\r\n                </td>\r\n                <td style={{ padding: '16px' }}>\r\n                  <span style={{ fontSize: '12px', padding: '4px 10px', borderRadius: '12px', background: '#F5F5F7', color: '#666' }}>\r\n                    {item.category}\r\n                  </span>\r\n                </td>\r\n                <td style={{ padding: '16px' }}>\r\n                  <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\r\n                    <span style={{ fontWeight: 600 }}>{calculateStock(item.variants)}</span>\r\n                    {calculateStock(item.variants) < 5 && (\r\n                      <span style={{ fontSize: '10px', color: '#FF9500', fontWeight: 'bold' }}>LOW</span>\r\n                    )}\r\n                  </div>\r\n                </td>\r\n                <td style={{ padding: '16px', fontWeight: 'bold' }}>\r\n                  {item.currency === 'USD' ? '$' : item.currency === 'EUR' ? 'Γé¼' : ''}\r\n                  {item.sellPrice}\r\n                  {item.currency === 'IQD' ? ' IQD' : ''}\r\n                </td>\r\n                {hasPermission('INVENTORY_WRITE') && (\r\n                    <td style={{ padding: '16px 24px', textAlign: 'right' }}>\r\n                    <div style={{ display: 'flex', justifyContent: 'flex-end', gap: '8px' }}>\r\n                        <button className=\"btn\" style={{ padding: '6px', color: '#555' }} onClick={() => navigate(`/warehouse/branches/${branchId}/edit-item/${item.id}`)}><Edit2 size={16}/></button>\r\n                        <button className=\"btn\" style={{ padding: '6px', color: '#FF3B30' }} onClick={() => handleDelete(item.id)}><Trash2 size={16}/></button>\r\n                    </div>\r\n                    </td>\r\n                )}\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n      </motion.div>\r\n    </motion.div>\r\n  );\r\n};\r\n\r\nconst StatCard = ({ title, value, icon: Icon, color }) => (\r\n  <div className=\"card\" style={{ padding: '24px', display: 'flex', alignItems: 'center', gap: '16px', borderTop: `4px solid ${color}` }}>\r\n    <div style={{ padding: '12px', borderRadius: '12px', background: `${color}15`, color: color }}>\r\n      <Icon size={24} />\r\n    </div>\r\n    <div>\r\n      <div style={{ fontSize: '12px', color: '#888', fontWeight: 600 }}>{title}</div>\r\n      <div style={{ fontSize: '24px', fontWeight: 'bold' }}>{value}</div>\r\n    </div>\r\n  </div>\r\n);\r\n\r\nexport default BranchInventoryView;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\NIPEAL\\Desktop\\ClothingStore\\my-react-app\\src\\features\\warehouse\\inventory\\CategoryManagerView.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\NIPEAL\\Desktop\\ClothingStore\\my-react-app\\src\\features\\warehouse\\inventory\\inventoryService.js","messages":[{"ruleId":"no-dupe-keys","severity":2,"message":"Duplicate key 'getItemById'.","line":45,"column":9,"nodeType":"ObjectExpression","messageId":"unexpected","endLine":45,"endColumn":20},{"ruleId":"no-unused-vars","severity":2,"message":"'docSnap' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":46,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":46,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"docSnap"},"fix":{"range":[1240,1339],"text":""},"desc":"Remove unused variable 'docSnap'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { collection, query, where, getDocs, addDoc, doc, deleteDoc, updateDoc, getDoc } from \"firebase/firestore\";\r\nimport { db } from \"../../../lib/firebase\";\r\n\r\nexport const inventoryService = {\r\n  /**\r\n   * Fetch inventory for a specific branch\r\n   * @param {string} branchId \r\n   */\r\n  async getBranchInventory(branchId) {\r\n    try {\r\n      const q = query(\r\n        collection(db, \"inventory\"), \r\n        where(\"branchId\", \"==\", branchId)\r\n      );\r\n      const querySnapshot = await getDocs(q);\r\n      return querySnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n    } catch (error) {\r\n      console.error(\"Error fetching inventory:\", error);\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Get single item by ID\r\n   * @param {string} itemId \r\n   */\r\n  async getItemById(itemId) {\r\n    try {\r\n      const docRef = doc(db, \"inventory\", itemId);\r\n      const docSnap = await getDoc(docRef);\r\n      if (docSnap.exists()) {\r\n        return { id: docSnap.id, ...docSnap.data() };\r\n      }\r\n      return null;\r\n    } catch (error) {\r\n      console.error(\"Error fetching item:\", error);\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Get single item by ID\r\n   * @param {string} itemId \r\n   */\r\n  async getItemById(itemId) {\r\n    const docSnap = await getDocs(query(collection(db, \"inventory\"), where(\"__name__\", \"==\", itemId))); \r\n    // Note: getDoc(doc(db, \"inventory\", itemId)) is cleaner/cheaper than query\r\n    // But keeping import consistency. actually let's use getDoc if imported.\r\n    // simpler:\r\n    // const docRef = doc(db, \"inventory\", itemId);\r\n    // const docSnap = await getDoc(docRef);\r\n    // But I need to import getDoc.\r\n    // Let's stick to getDocs(query) if getDoc isn't imported, OR add import.\r\n    // Looking at line 1: getDocs, addDoc, doc, deleteDoc, updateDoc ARE imported. getDoc is NOT.\r\n    // I will add getDoc to imports first.\r\n    return null; \r\n  },\r\n\r\n  /**\r\n   * Add new item to inventory\r\n   * @param {object} itemData \r\n   */\r\n  async addItem(itemData) {\r\n    try {\r\n      // Create keywords for search (basic implementation)\r\n      const keywords = itemData.name.toLowerCase().split(' ');\r\n      \r\n      const docRef = await addDoc(collection(db, \"inventory\"), {\r\n        ...itemData,\r\n        keywords,\r\n        createdAt: new Date().toISOString()\r\n      });\r\n      return docRef.id;\r\n    } catch (error) {\r\n      console.error(\"Error adding item:\", error);\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Delete item\r\n   */\r\n  async deleteItem(itemId) {\r\n    await deleteDoc(doc(db, \"inventory\", itemId));\r\n  },\r\n\r\n  /**\r\n   * Update Item\r\n   */\r\n  async updateItem(itemId, data) {\r\n    await updateDoc(doc(db, \"inventory\", itemId), data);\r\n  },\r\n\r\n  // --- POS METHODS ---\r\n\r\n  /**\r\n   * Find product by barcode\r\n   * @param {string} barcode \r\n   */\r\n  async getProductByBarcode(barcode) {\r\n    const q = query(\r\n      collection(db, \"inventory\"), \r\n      where(\"barcode\", \"==\", barcode)\r\n    );\r\n    const snapshot = await getDocs(q);\r\n    if (!snapshot.empty) {\r\n      const doc = snapshot.docs[0];\r\n      return { id: doc.id, ...doc.data() };\r\n    }\r\n    return null;\r\n  },\r\n\r\n  /**\r\n   * Get Categories\r\n   */\r\n  async getCategories() {\r\n    // We can store categories globally or per branch. For now, global 'categories' collection.\r\n    const q = query(collection(db, \"categories\")); \r\n    const snapshot = await getDocs(q);\r\n    return snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n  },\r\n\r\n  /**\r\n   * Add Category (Prevent Duplicates)\r\n   */\r\n  async addCategory(name) {\r\n    const trimmedName = name.trim();\r\n    // Check if exists\r\n    const q = query(collection(db, \"categories\"), where(\"name\", \"==\", trimmedName));\r\n    const snapshot = await getDocs(q);\r\n    \r\n    if (!snapshot.empty) {\r\n        throw new Error(\"Category already exists\");\r\n    }\r\n\r\n    const docRef = await addDoc(collection(db, \"categories\"), {\r\n       name: trimmedName,\r\n       count: 0\r\n    });\r\n    return { id: docRef.id, name: trimmedName };\r\n  },\r\n\r\n  /**\r\n   * Delete Category\r\n   */\r\n  async deleteCategory(categoryId) {\r\n    await deleteDoc(doc(db, \"categories\", categoryId));\r\n  },\r\n\r\n  /**\r\n   * Process Sale (Atomic Stock Update)\r\n   * @param {Array} cartItems \r\n   */\r\n  async processSale(cartItems) {\r\n    console.log(\"Processing Sale for items:\", cartItems);\r\n    try {\r\n      // Loop through items and update inventory sequentially to avoid race conditions on same doc\r\n      for (const item of cartItems) {\r\n        if (!item.id) {\r\n            console.error(\"Item missing ID, skipping:\", item);\r\n            continue;\r\n        }\r\n\r\n        const itemRef = doc(db, \"inventory\", item.id);\r\n        const itemSnap = await getDoc(itemRef);\r\n        \r\n        if (itemSnap.exists()) {\r\n          const data = itemSnap.data();\r\n          console.log(`Found item ${item.name} (ID: ${item.id}). Current Stock: ${data.stock}`);\r\n          \r\n          let currentVariants = data.variants || [];\r\n          \r\n          // Fallback if no variants\r\n          if (currentVariants.length === 0) {\r\n             console.log(\"No variants found, creating default variant from stock.\");\r\n             currentVariants = [{ id: Date.now(), color: 'Standard', size: 'One Size', quantity: Number(data.stock) || 0 }];\r\n          }\r\n\r\n          // Deduct from the first variant (MVP Logic)\r\n          const qtyToDeduct = Number(item.qty) || 0;\r\n          const currentQty = Number(currentVariants[0].quantity) || 0;\r\n          const newQty = Math.max(0, currentQty - qtyToDeduct);\r\n          \r\n          console.log(`Deducting ${qtyToDeduct} from ${currentQty}. New Variant Qty: ${newQty}`);\r\n\r\n          currentVariants[0].quantity = newQty;\r\n\r\n          // Recalculate Total Stock from variants\r\n          const newTotalStock = currentVariants.reduce((acc, v) => acc + (Number(v.quantity) || 0), 0);\r\n          console.log(`New Document Total Stock: ${newTotalStock}`);\r\n\r\n          await updateDoc(itemRef, {\r\n            stock: newTotalStock,\r\n            variants: currentVariants\r\n          });\r\n          console.log(\"Document updated successfully.\");\r\n        } else {\r\n            console.error(\"Item document not found:\", item.id);\r\n        }\r\n      }\r\n      return true;\r\n    } catch (e) {\r\n      console.error(\"Sale processing error\", e);\r\n      throw e;\r\n    }\r\n  }\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\NIPEAL\\Desktop\\ClothingStore\\my-react-app\\src\\features\\warehouse\\services\\branchService.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\NIPEAL\\Desktop\\ClothingStore\\my-react-app\\src\\lib\\fcmService.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\NIPEAL\\Desktop\\ClothingStore\\my-react-app\\src\\lib\\firebase.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\NIPEAL\\Desktop\\ClothingStore\\my-react-app\\src\\main.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\NIPEAL\\Desktop\\ClothingStore\\my-react-app\\vite.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]
